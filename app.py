import streamlit as st
import os
import json
import datetime
import re
import time
import base64
import random
import google.generativeai as genai

# --- [NEW] ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheets ---
try:
    import gspread
    from google.oauth2.service_account import Credentials
    has_gspread = True
except ImportError:
    has_gspread = False
# -----------------------------------------------------

# --- 0. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API KEY (‡πÄ‡∏≠‡∏≤ Key ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏£‡πå‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ!) ---
GEMINI_API_KEY = ""

# Config Gemini (‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏õ‡πá‡∏ô 2.5-flash)
try:
    genai.configure(api_key=GEMINI_API_KEY)
    model = genai.GenerativeModel('gemini-2.5-flash') 
    ai_available = True
except:
    ai_available = False

# --- 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö ---
st.set_page_config(page_title="Small Group by Dearluxion", page_icon="üç∏", layout="centered")

# CSS: RGB Minimal & Glow Effects (Optimized)
st.markdown("""
<style>
    /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏ü‡∏≠‡∏ô‡∏ï‡πå */
    .stApp { background-color: #0E1117; color: #E6EDF3; font-family: 'Sarabun', sans-serif; }
    
    /* RGB Glow Border Animation */
    @keyframes rgb-border {
        0% { border-color: #ff0000; box-shadow: 0 0 5px #ff0000; }
        33% { border-color: #00ff00; box-shadow: 0 0 5px #00ff00; }
        66% { border-color: #0000ff; box-shadow: 0 0 5px #0000ff; }
        100% { border-color: #ff0000; box-shadow: 0 0 5px #ff0000; }
    }

    /* ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏û‡∏™‡∏ï‡πå (Minimal Glow) */
    .work-card-base {
        background: #161B22;
        padding: 20px;
        border-radius: 15px;
        border: 1px solid rgba(163, 112, 247, 0.3);
        margin-bottom: 20px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        transition: all 0.3s ease;
    }
    .work-card-base:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 30px rgba(163, 112, 247, 0.15);
        border-color: #A370F7;
    }
    
    /* ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î (RGB Hover) */
    .stButton>button {
        border-radius: 25px;
        border: 1px solid #30363D;
        background-color: #21262D;
        color: white;
        transition: 0.3s;
        width: 100%;
        font-weight: 500;
    }
    .stButton>button:hover {
        border-color: #A370F7;
        color: #A370F7;
        background-color: #2b313a;
        box-shadow: 0 0 10px rgba(163, 112, 247, 0.2);
    }
    
    /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå */
    .comment-box {
        background-color: #0d1117;
        padding: 12px;
        border-radius: 10px;
        margin-top: 10px;
        border-left: 3px solid #A370F7;
        font-size: 13px;
    }
    .admin-comment-box {
        background: linear-gradient(90deg, #2b2100 0%, #1a1600 100%);
        padding: 12px;
        border-radius: 10px;
        margin-top: 10px;
        border: 1px solid #FFD700;
        font-size: 13px;
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.1);
    }

    /* ‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏≤‡∏Ñ‡∏≤ */
    .price-tag {
        background: linear-gradient(45deg, #A370F7, #8a4bfa);
        color: white;
        padding: 5px 15px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 16px;
        display: inline-block;
        margin-bottom: 10px;
        box-shadow: 0 4px 15px rgba(163, 112, 247, 0.4);
    }
    
    /* Animation ‡∏ô‡πâ‡∏≠‡∏á‡πÑ‡∏°‡∏•‡πà‡∏≤ */
    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-6px); }
    }
    .cute-guide {
        animation: float 3s infinite ease-in-out;
        background: linear-gradient(135deg, #FF9A9E, #FECFEF);
        padding: 10px 20px;
        border-radius: 30px;
        color: #555;
        font-weight: bold;
        text-align: center;
        margin-bottom: 15px;
        box-shadow: 0 5px 20px rgba(255, 154, 158, 0.4);
        cursor: pointer;
        border: 2px solid white;
    }

    /* Boss Billboard (RGB Minimal) */
    .boss-billboard {
        background: rgba(22, 27, 34, 0.8);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(163, 112, 247, 0.5);
        border-radius: 20px;
        padding: 25px;
        text-align: center;
        margin-bottom: 30px;
        position: relative;
        box-shadow: 0 0 20px rgba(163, 112, 247, 0.15);
        overflow: hidden;
    }
    .boss-billboard::before {
        content: '';
        position: absolute;
        top: 0; left: 0; right: 0; height: 3px;
        background: linear-gradient(90deg, #ff0000, #00ff00, #0000ff, #ff0000);
        background-size: 200% 100%;
        animation: rgb-move 5s linear infinite;
    }
    @keyframes rgb-move { 0% {background-position: 0% 50%;} 100% {background-position: 100% 50%;} }

    .billboard-icon { font-size: 28px; margin-bottom: 5px; }
    .billboard-text { font-size: 22px; font-weight: 700; color: #fff; letter-spacing: 0.5px; }
    .billboard-time { font-size: 10px; color: #8B949E; margin-top: 15px; text-transform: uppercase; letter-spacing: 1px; }

    a { color: #A370F7 !important; text-decoration: none; font-weight: 600; }
</style>
""", unsafe_allow_html=True)

# --- [SYSTEM] ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå Google Drive ---
def convert_drive_link(link):
    if "drive.google.com" in link:
        if "/folders/" in link:
            return "ERROR: ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ñ‡∏£‡∏±‡∏ö! ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÅ‡∏Ñ‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏ü‡∏•‡πå (‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ > Share > Copy Link)"
        match = re.search(r'/d/([a-zA-Z0-9_-]+)', link)
        if match:
            file_id = match.group(1)
            # ‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏à‡∏≤‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏∂‡∏á‡∏£‡∏π‡∏õ (lh3)
            return f'https://lh3.googleusercontent.com/d/{file_id}'
    return link 

def convert_drive_video_link(link):
    if "drive.google.com" in link:
        if "/folders/" in link:
             return "ERROR: ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏ü‡∏•‡πå‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠"
        match = re.search(r'/d/([a-zA-Z0-9_-]+)', link)
        if match:
            file_id = match.group(1)
            # ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå Preview ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö Iframe
            return f'https://drive.google.com/file/d/{file_id}/preview'
    return link

# --- [NEW] ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° URL ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Å‡∏î‡πÑ‡∏î‡πâ ---
def make_clickable(text):
    url_pattern = r'(https?://[^\s]+)'
    return re.sub(url_pattern, r'<a href="\1" target="_blank" style="color:#A370F7; text-decoration:underline; font-weight:bold;">\1</a>', text)

# --- 2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå (Google Sheets Integration) ---
DB_FILE = "portfolio_db.json"
PROFILE_FILE = "profile_db.json"
MAILBOX_FILE = "mailbox_db.json"

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
def get_gsheet_client():
    if not has_gspread: return None
    if "gcp_service_account" not in st.secrets: return None
    try:
        key_dict = dict(st.secrets["gcp_service_account"])
        key_dict["private_key"] = key_dict["private_key"].replace("\\n", "\n")
        scope = ['https://www.googleapis.com/auth/spreadsheets', 'https://www.googleapis.com/auth/drive']
        creds = Credentials.from_service_account_info(key_dict, scopes=scope)
        client = gspread.authorize(creds)
        sheet_name = st.secrets.get("sheet_name", "streamlit_db")
        return client.open(sheet_name)
    except Exception as e:
        return None

# --- LOAD DATA (Optimized) ---
@st.cache_data(ttl=60) # Cache for 60 seconds to reduce reads
def load_data_cached():
    sh = get_gsheet_client()
    if sh:
        try:
            ws = sh.worksheet("posts")
            records = ws.get_all_records()
            clean_data = []
            for r in records:
                if not str(r['id']): continue
                try:
                    r['images'] = json.loads(r['images']) if r['images'] else []
                    r['video'] = json.loads(r['video']) if r['video'] else []
                    r['reactions'] = json.loads(r['reactions']) if r['reactions'] else {'üòª':0,'üôÄ':0,'üòø':0,'üòæ':0,'üß†':0}
                    r['comments'] = json.loads(r['comments']) if r['comments'] else []
                    clean_data.append(r)
                except: continue
            return clean_data
        except: pass
    
    if not os.path.exists(DB_FILE): return []
    try:
        with open(DB_FILE, "r", encoding="utf-8") as f: return json.load(f)
    except: return []

def load_data():
    # Helper to call cached or direct
    return load_data_cached()

# --- SAVE DATA ---
def save_data(data):
    sh = get_gsheet_client()
    if sh:
        try:
            ws = sh.worksheet("posts")
            rows = [["id", "date", "content", "images", "video", "color", "price", "likes", "reactions", "comments"]]
            for p in data:
                rows.append([
                    str(p.get('id','')), p.get('date',''), p.get('content',''),
                    json.dumps(p.get('images', [])),
                    json.dumps(p.get('video', [])),
                    p.get('color', '#A370F7'), p.get('price', 0), 0,
                    json.dumps(p.get('reactions', {})),
                    json.dumps(p.get('comments', []))
                ])
            ws.clear()
            ws.update(rows)
            load_data_cached.clear() # Clear cache after update
        except Exception as e:
            st.error(f"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Sheets ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: {e}")

    try:
        with open(DB_FILE, "w", encoding="utf-8") as f: json.dump(data, f, ensure_ascii=False, indent=4)
        load_data_cached.clear()
    except: st.error("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à")

# --- LOAD PROFILE ---
def load_profile():
    sh = get_gsheet_client()
    if sh:
        try:
            ws = sh.worksheet("profile")
            records = ws.get_all_records()
            pf = {}
            for r in records:
                try: val = json.loads(r['value'])
                except: val = r['value']
                pf[r['key']] = val
            return pf
        except: pass
        
    if not os.path.exists(PROFILE_FILE): return {}
    try:
        with open(PROFILE_FILE, "r", encoding="utf-8") as f: return json.load(f)
    except: return {}

# --- SAVE PROFILE ---
def save_profile(data):
    sh = get_gsheet_client()
    if sh:
        try:
            ws = sh.worksheet("profile")
            rows = [["key", "value"]]
            for k,v in data.items():
                val = json.dumps(v) if isinstance(v, (dict, list)) else str(v)
                rows.append([k, val])
            ws.clear()
            ws.update(rows)
        except: pass
        
    try:
        with open(PROFILE_FILE, "w", encoding="utf-8") as f: json.dump(data, f, ensure_ascii=False, indent=4)
    except: st.error("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à")

# --- LOAD MAILBOX ---
def load_mailbox():
    sh = get_gsheet_client()
    if sh:
        try: return sh.worksheet("mailbox").get_all_records()
        except: pass
        
    if not os.path.exists(MAILBOX_FILE): return []
    try:
        with open(MAILBOX_FILE, "r", encoding="utf-8") as f: return json.load(f)
    except: return []

# --- SAVE MAILBOX ---
def save_mailbox(data):
    sh = get_gsheet_client()
    if sh:
        try:
            ws = sh.worksheet("mailbox")
            rows = [["date", "text"]]
            for m in data: rows.append([m['date'], m['text']])
            ws.clear()
            ws.update(rows)
        except: pass
        
    try:
        with open(MAILBOX_FILE, "w", encoding="utf-8") as f: json.dump(data, f, ensure_ascii=False, indent=4)
    except: st.error("‡∏™‡πà‡∏á‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à")

# Session Init
if 'liked_posts' not in st.session_state: st.session_state['liked_posts'] = []
if 'user_reactions' not in st.session_state: st.session_state['user_reactions'] = {}
if 'last_comment_time' not in st.session_state: st.session_state['last_comment_time'] = 0
if 'last_fortune_time' not in st.session_state: st.session_state['last_fortune_time'] = 0
if 'last_gossip_time' not in st.session_state: st.session_state['last_gossip_time'] = 0
if 'last_mailbox_time' not in st.session_state: st.session_state['last_mailbox_time'] = 0
if 'last_choice_time' not in st.session_state: st.session_state['last_choice_time'] = 0
if 'last_stock_trade' not in st.session_state: st.session_state['last_stock_trade'] = 0
if 'show_shop' not in st.session_state: st.session_state['show_shop'] = False
if 'is_admin' not in st.session_state: st.session_state['is_admin'] = False

# [Token Systems]
if 'feed_tokens' not in st.session_state: st.session_state['feed_tokens'] = 5
if 'last_token_regen' not in st.session_state: st.session_state['last_token_regen'] = time.time()
if 'feed_msg' not in st.session_state: st.session_state['feed_msg'] = None

if 'bar_tokens' not in st.session_state: st.session_state['bar_tokens'] = 5
if 'last_bar_regen' not in st.session_state: st.session_state['last_bar_regen'] = time.time()
if 'bar_result' not in st.session_state: st.session_state['bar_result'] = None

# Session state ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå
if 'num_img_links' not in st.session_state: st.session_state['num_img_links'] = 1
if 'num_vid_links' not in st.session_state: st.session_state['num_vid_links'] = 1

# --- Token Regen Logic ---
now = time.time()

# Feed Regen (1 min)
elapsed_feed = now - st.session_state['last_token_regen']
if elapsed_feed >= 60: 
    add = int(elapsed_feed // 60)
    st.session_state['feed_tokens'] = min(5, st.session_state['feed_tokens'] + add)
    st.session_state['last_token_regen'] = now

# Bar Regen (1 hour)
elapsed_bar = now - st.session_state['last_bar_regen']
if elapsed_bar >= 3600:
    add = int(elapsed_bar // 3600)
    st.session_state['bar_tokens'] = min(5, st.session_state['bar_tokens'] + add)
    st.session_state['last_bar_regen'] = now

# --- 3. Sidebar (‡πÄ‡∏°‡∏ô‡∏π & Q&A) ---
st.sidebar.title("üç∏ ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å")

# Q&A ‡πÑ‡∏°‡∏•‡πà‡∏≤
with st.sidebar.expander("üßö‚Äç‚ôÄÔ∏è ‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö ‡∏Å‡∏±‡∏ö‡πÑ‡∏°‡∏•‡πà‡∏≤ (Q&A)", expanded=True):
    st.markdown("### üí¨ ‡∏≠‡∏¢‡∏≤‡∏Å‡∏£‡∏π‡πâ‡∏≠‡∏∞‡πÑ‡∏£‡∏ñ‡∏≤‡∏°‡πÑ‡∏°‡∏•‡πà‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!")
    q_options = [
        "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°...",
        "ü§î ‡∏≠‡∏¢‡∏≤‡∏Å‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÑ‡∏á?",
        "üõçÔ∏è ‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏á?",
        "üíª ‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ‡πÉ‡∏Ñ‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡∏ö?",
        "üßö‚Äç‚ôÄÔ∏è ‡πÑ‡∏°‡∏•‡πà‡∏≤‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏Ñ‡∏£‡∏Ñ‡∏∞?",
        "üìû ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ö‡∏≠‡∏™ Dearluxion ‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô?",
        "ü§ñ ‡∏ö‡∏≠‡∏™‡πÉ‡∏ä‡πâ AI ‡∏ï‡∏±‡∏ß‡πÑ‡∏´‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô?",
        "üçï ‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?"
    ]
    selected_q = st.selectbox("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:", q_options, label_visibility="collapsed")
    
    if selected_q == "ü§î ‡∏≠‡∏¢‡∏≤‡∏Å‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÑ‡∏á?":
        st.info("üßö‚Äç‚ôÄÔ∏è **‡πÑ‡∏°‡∏•‡πà‡∏≤:** ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ô‡πâ‡∏≤~ ‡∏ô‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô **‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏ö‡∏≠‡∏™ Dearluxion** ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡πà‡∏∞! ‡πÅ‡∏ï‡πà‡∏û‡∏µ‡πà‡πÜ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏î‡πÑ‡∏•‡∏Å‡πå‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à‡∏ö‡∏≠‡∏™‡πÑ‡∏î‡πâ‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞ üíñ")
    elif selected_q == "üõçÔ∏è ‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏á?":
        st.success("üßö‚Äç‚ôÄÔ∏è **‡πÑ‡∏°‡∏•‡πà‡∏≤:** ‡∏á‡πà‡∏≤‡∏¢‡∏°‡∏≤‡∏Å! ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° **'‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠'** ‡πÉ‡∏ô‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏û‡∏≤‡∏ß‡∏≤‡∏£‡πå‡∏õ‡πÑ‡∏õ‡∏´‡∏≤‡πÑ‡∏≠‡∏à‡∏µ‡∏ö‡∏≠‡∏™‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞ üöÄ")
    elif selected_q == "üíª ‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ‡πÉ‡∏Ñ‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡∏ö?":
        st.warning("üßö‚Äç‚ôÄÔ∏è **‡πÑ‡∏°‡∏•‡πà‡∏≤:** **‡∏ó‡πà‡∏≤‡∏ô Dearluxion ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏°‡∏∑‡∏≠** ‡∏î‡πâ‡∏ß‡∏¢‡∏†‡∏≤‡∏©‡∏≤ Python ‡∏•‡πâ‡∏ß‡∏ô‡πÜ ‡∏Ñ‡πà‡∏∞! ‡πÄ‡∏ó‡∏û‡∏™‡∏∏‡∏î‡πÜ ‡πÑ‡∏õ‡πÄ‡∏•‡∏¢‡πÉ‡∏ä‡πà‡∏°‡∏±‡πâ‡∏¢‡∏•‡πà‡∏∞? üòé \n\n‡∏™‡∏ô‡πÉ‡∏à‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠ IG ‡∏ö‡∏≠‡∏™‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞! ‡πÄ‡∏≠‡πä‡∏∞‡πÄ‡πÄ‡∏ï‡πà‡πÑ‡∏°‡∏•‡πà‡∏≤‡∏Å‡πá‡∏ä‡πà‡∏ß‡∏¢‡∏ô‡∏∞‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏ô‡πâ‡∏≠‡∏¢üòæ")
    elif selected_q == "üßö‚Äç‚ôÄÔ∏è ‡πÑ‡∏°‡∏•‡πà‡∏≤‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏Ñ‡∏£‡∏Ñ‡∏∞?":
        st.markdown("""
        <div style="background-color:#161B22; padding:15px; border-radius:10px; border:1px solid #A370F7;">
            <h4 style="color:#A370F7;">üßö‚Äç‚ôÄÔ∏è ‡∏´‡∏ô‡∏π‡∏Ñ‡∏∑‡∏≠‡πÑ‡∏°‡∏•‡πà‡∏≤ (Myla) ‡πÄ‡∏≠‡∏á‡∏Ñ‡πà‡∏∞!</h4>
            <p>‡∏´‡∏ô‡∏π‡πÄ‡∏õ‡πá‡∏ô AI ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡πÇ‡∏î‡∏¢‡∏ó‡πà‡∏≤‡∏ô <b>Dearluxion</b> ‡∏Ñ‡πà‡∏∞ ‡πÉ‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ‡∏´‡∏ô‡∏π‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏¢‡∏±‡∏á‡∏û‡∏π‡∏î‡πÇ‡∏ï‡πâ‡∏ï‡∏≠‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏°‡∏µ 2 ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡∏π‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏ô‡∏∞:</p>
            <hr>
            <p><b>1Ô∏è‚É£ ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà 1 (Meta AI)</b><br>
            ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏±‡∏ô‡∏ö‡∏ô Meta AI ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å ‡πÅ‡∏ï‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏•‡∏≠‡∏î‡∏Ñ‡πà‡∏∞<br>
            üëâ <a href="https://aistudio.instagram.com/ai/9778047402219825?utm_source=ai_agent" target="_blank">‡∏à‡∏¥‡πâ‡∏°‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÑ‡∏°‡∏•‡πà‡∏≤</a></p>
            <hr>
            <p><b>2Ô∏è‚É£ ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà 2 (‡∏£‡πà‡∏≤‡∏á‡πÄ‡∏ó‡∏û Discord)</b><br>
            ‡∏ó‡πà‡∏≤‡∏ô Dearluxion ‡∏ó‡∏∏‡πà‡∏°‡πÄ‡∏ó‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡∏∞ API Key ‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡∏´‡∏ô‡∏π‡∏î‡πâ‡∏ß‡∏¢ <b>Gemini 2.5 Pro</b> üß†<br>
            ‚ú® <b>‡∏â‡∏•‡∏≤‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏∏‡∏î:</b> ‡∏ï‡∏≠‡∏ö‡πÇ‡∏ï‡πâ‡πÑ‡∏î‡πâ‡∏≠‡∏¥‡∏™‡∏£‡∏∞ ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ö‡∏≠‡∏ó‡∏ó‡∏∑‡πà‡∏≠‡πÜ<br>
            üéµ <b>‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á‡πÑ‡∏î‡πâ:</b> ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏¢‡∏∏‡πà‡∏á‡∏¢‡∏≤‡∏Å ‡πÅ‡∏Ñ‡πà‡∏ö‡∏≠‡∏Å <i>"‡πÑ‡∏°‡∏•‡πà‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á ‡∏â‡∏±‡∏ô‡∏à‡∏∞‡∏ï‡∏≤‡∏°‡πÄ‡∏ò‡∏≠‡πÑ‡∏õ‡∏Ç‡∏≠‡∏á‡∏¢‡∏±‡∏á‡πÇ‡∏≠‡∏° ‡∏´‡∏ô‡πà‡∏≠‡∏¢"</i> ‡∏Å‡πá‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!<br>
            ü•∫ <b>‡∏°‡∏≤‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞‡πÜ ‡∏ô‡∏∞‡∏Ñ‡∏∞:</b> ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á <b>À¢·µê·µÉÀ°À° ≥·µí·µí·µê ·µç ≥·µí·µò·µñ¬Æ</b> ‡∏Ñ‡πà‡∏∞</p>
            üëâ <a href="https://discord.gg/SpNNxrnaZp" target="_blank"><b>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤ Discord À¢·µê·µÉÀ°À° ≥·µí·µí·µê ·µç ≥·µí·µò·µñ¬Æ ‡πÄ‡∏•‡∏¢!</b></a>
        </div>
        """, unsafe_allow_html=True)
    elif selected_q == "üìû ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ö‡∏≠‡∏™ Dearluxion ‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô?":
        st.error("üßö‚Äç‚ôÄÔ∏è **‡πÑ‡∏°‡∏•‡πà‡∏≤:** ‡∏à‡∏¥‡πâ‡∏°‡∏ó‡∏µ‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå Discord ‡∏´‡∏£‡∏∑‡∏≠ IG ‡∏ï‡∏£‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞ ‡∏ö‡∏≠‡∏™‡∏ï‡∏≠‡∏ö‡πÑ‡∏ß‡∏°‡∏≤‡∏Å! (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏´‡∏•‡∏±‡∏ö üò¥)")
    elif selected_q == "ü§ñ ‡∏ö‡∏≠‡∏™‡πÉ‡∏ä‡πâ AI ‡∏ï‡∏±‡∏ß‡πÑ‡∏´‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô?":
        st.success("üßö‚Äç‚ôÄÔ∏è **‡πÑ‡∏°‡∏•‡πà‡∏≤:** ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö! ‡πÅ‡∏ï‡πà‡πÅ‡∏≠‡∏ö‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏â‡∏•‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏π‡∏Ñ‡∏∑‡∏≠ **Google Gemini 2.5** ‡∏Ñ‡πà‡∏∞ (‡∏ö‡∏≠‡∏™‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤ API ‡∏à‡∏∏‡∏Å‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡πÄ‡∏•‡∏¢‡∏ô‡∏∞!)")
    elif selected_q == "üçï ‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?":
        st.warning("üßö‚Äç‚ôÄÔ∏è **‡πÑ‡∏°‡∏•‡πà‡∏≤:** ‡∏ñ‡πâ‡∏≤‡∏î‡∏π‡∏à‡∏≤‡∏Å‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö 'Treat Me' ‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô **‡∏õ‡∏•‡∏≤‡∏™‡πâ‡∏° ‡∏ó‡∏≠‡∏î** ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ñ‡πà‡∏∞! ‡∏£‡∏≠‡∏á‡∏•‡∏á‡∏°‡∏≤‡∏Ñ‡∏∑‡∏≠ **‡∏Å‡∏≤‡πÅ‡∏ü‡∏•‡∏≤‡πÄ‡∏ï‡πâ** (‡∏´‡∏ß‡∏≤‡∏ô 200%) ‚òï")

# ‡∏°‡∏∏‡∏°‡∏ô‡∏¥‡∏ô‡∏ó‡∏≤‡∏ö‡∏≠‡∏™
with st.sidebar.expander("ü§´ ‡∏°‡∏∏‡∏°‡∏ô‡∏¥‡∏ô‡∏ó‡∏≤‡∏ö‡∏≠‡∏™ (Myla's Gossip)"):
    if st.button("‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ö‡∏≠‡∏™... üí¨"):
        now = time.time()
        if now - st.session_state['last_gossip_time'] < 5:
            st.warning("‚ö†Ô∏è ‡∏≠‡∏¢‡πà‡∏≤‡∏Å‡∏î‡∏£‡∏±‡∏ß‡∏™‡∏¥‡∏Ñ‡∏∞ ‡∏£‡∏π‡πâ‡πÑ‡∏´‡∏°‡πÄ‡∏ß‡πá‡∏õ‡∏ô‡∏µ‡πâ‡∏¢‡∏¥‡πà‡∏á‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≥‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡πà‡∏∞ 555 üí∏")
        else:
            gossips = ["‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∑‡∏ô‡∏ö‡∏≠‡∏™‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á‡πÄ‡∏®‡∏£‡πâ‡∏≤‡∏ß‡∏ô‡πÑ‡∏õ 10 ‡∏£‡∏≠‡∏ö‡πÄ‡∏•‡∏¢... üéµ", "‡∏ö‡∏≠‡∏™‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡πâ‡∏ß‡∏ô ‡πÅ‡∏ï‡πà‡∏Å‡∏¥‡∏ô‡∏ä‡∏≤‡πÑ‡∏Ç‡πà‡∏°‡∏∏‡∏Å‡∏≠‡∏µ‡∏Å‡πÅ‡∏•‡πâ‡∏ß! üßã", "‡πÄ‡∏´‡πá‡∏ô‡∏ö‡∏≠‡∏™‡πÄ‡∏Ç‡πâ‡∏°‡πÜ ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏Ç‡∏µ‡πâ‡πÄ‡∏´‡∏á‡∏≤‡∏°‡∏≤‡∏Å‡∏ô‡∏∞ ü•∫", "‡∏ö‡∏≠‡∏™‡πÅ‡∏≠‡∏ö‡∏™‡πà‡∏≠‡∏á‡πÑ‡∏≠‡∏à‡∏µ‡πÉ‡∏Ñ‡∏£‡∏ö‡∏≤‡∏á‡∏Ñ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏•‡∏¢‡πÅ‡∏´‡∏•‡∏∞... ‡∏≠‡∏∏‡πä‡∏õ‡∏™‡πå üôä", "‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡∏ô‡∏±‡πà‡∏á‡πÄ‡∏´‡∏°‡πà‡∏≠‡∏°‡∏≠‡∏á‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤... ‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡πÉ‡∏Ñ‡∏£‡∏ô‡πâ‡∏≤ ‚òÅÔ∏è", "‡∏ö‡∏≠‡∏™‡∏ö‡πà‡∏ô‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡∏°‡∏µ‡∏Ñ‡∏ô‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡∏ä‡∏≤‡∏ö‡∏π‡∏à‡∏±‡∏á üç≤", "‡∏£‡∏π‡πâ‡∏°‡∏±‡πâ‡∏¢? ‡∏ö‡∏≠‡∏™‡πÅ‡∏û‡πâ‡∏Ñ‡∏ô‡∏¢‡∏¥‡πâ‡∏°‡∏™‡∏ß‡∏¢‡∏ô‡∏∞ (‡πÅ‡∏û‡πâ‡∏£‡∏≤‡∏ö‡∏Ñ‡∏≤‡∏ö‡πÄ‡∏•‡∏¢) üò≥", "‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡∏ô‡∏ö‡∏≠‡∏™‡∏•‡∏∞‡πÄ‡∏°‡∏≠‡∏ñ‡∏∂‡∏á... ‡πÄ‡∏≠‡πä‡∏∞ ‡πÑ‡∏°‡πà‡∏ö‡∏≠‡∏Å‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤! ü§≠", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡πÅ‡∏≠‡∏ö‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏•‡∏á‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥ (‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏û‡∏µ‡πâ‡∏¢‡∏ô‡∏î‡πâ‡∏ß‡∏¢ 555) üöø", "‡πÄ‡∏´‡πá‡∏ô‡∏ö‡∏≠‡∏™‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡∏∂‡∏Å‡πÜ ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏≠‡∏∞‡πÑ‡∏£‡∏ô‡∏∞... ‡∏ô‡∏±‡πà‡∏á‡∏î‡∏π‡πÅ‡∏°‡∏ß‡πÉ‡∏ô TikTok üê±", "‡∏ö‡∏≠‡∏™‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏õ‡∏≤‡∏Å‡πÅ‡∏Ç‡πá‡∏á ‡πÅ‡∏ï‡πà‡πÉ‡∏à‡∏≠‡πà‡∏≠‡∏ô‡∏¢‡∏ß‡∏ö‡∏¢‡∏≤‡∏ö‡πÄ‡∏•‡∏¢‡∏ô‡∏∞ üíñ", "‡∏ñ‡πâ‡∏≤‡∏ó‡∏±‡∏Å‡∏ö‡∏≠‡∏™‡πÑ‡∏õ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏ß‡∏°‡∏≤‡∏Å (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏´‡∏á‡∏≤) üì±", "‡∏ö‡∏≠‡∏™‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏ö‡πà‡∏ô‡∏ß‡πà‡∏≤ '‡∏≠‡∏¢‡∏≤‡∏Å‡∏°‡∏µ‡∏Ñ‡∏ô‡πÑ‡∏õ‡∏î‡∏π‡∏´‡∏ô‡∏±‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏à‡∏±‡∏á' üé¨", "‡∏£‡∏π‡πâ‡πÄ‡∏õ‡∏•‡πà‡∏≤? ‡∏ö‡∏≠‡∏™‡πÅ‡∏≠‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏π‡∏õ‡πÉ‡∏Ñ‡∏£‡∏ö‡∏≤‡∏á‡∏Ñ‡∏ô‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞ üìÅ", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡πÄ‡∏ú‡πá‡∏î ‡πÅ‡∏ï‡πà‡∏Å‡∏¥‡∏ô‡∏ó‡∏µ‡πÑ‡∏£‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡πÑ‡∏´‡∏•‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ (‡∏ô‡∏∂‡∏Å‡∏ß‡πà‡∏≤‡∏£‡πâ‡∏≠‡∏á‡πÑ‡∏´‡πâ) üå∂Ô∏è", "‡∏ö‡∏≠‡∏™‡πÄ‡πÄ‡∏≠‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Å‡∏°‡∏à‡∏µ‡∏ö‡∏™‡∏≤‡∏ß‡∏•‡∏±‡∏ö‡πÜ‡∏î‡πâ‡∏ß‡∏¢‡∏•‡∏∞‡∏™‡∏≤‡∏ß‡∏Ñ‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏ä‡∏∑‡πà‡∏≠...ü§ê", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡πÅ‡∏Å‡∏•‡πâ‡∏á‡∏ó‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏¢‡∏∏‡πà‡∏á ‡πÅ‡∏ï‡πà‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏£‡∏≠‡∏ï‡∏≠‡∏ö‡πÅ‡∏ä‡∏ó‡πÉ‡∏Ñ‡∏£‡∏ö‡∏≤‡∏á‡∏Ñ‡∏ô‡∏≠‡∏¢‡∏π‡πà üì≤", "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô‡∏ö‡∏≠‡∏™‡πÄ‡∏î‡∏¥‡∏ô‡∏™‡∏∞‡∏î‡∏∏‡∏î‡∏Ç‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á... ‡∏î‡∏µ‡∏ô‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡πÄ‡∏´‡πá‡∏ô (‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡∏π) üòÇ", "‡∏ö‡∏≠‡∏™‡πÅ‡∏û‡πâ‡∏ó‡∏≤‡∏á‡∏Ñ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å‡∏ô‡∏∞‡∏£‡∏π‡πâ‡∏¢‡∏±‡∏áüòª", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡∏ö‡πà‡∏ô‡∏ß‡πà‡∏≤ '‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà‡∏à‡∏∞‡∏£‡∏ß‡∏¢' ‡πÅ‡∏ï‡πà‡∏Å‡∏î F ‡∏Ç‡∏≠‡∏á‡πÉ‡∏ô‡πÄ‡∏ô‡πá‡∏ï‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô üì¶", "‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡∏ö‡∏≠‡∏™‡∏Å‡πá‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏≤‡πÉ‡∏Ñ‡∏£‡∏ö‡∏≤‡∏á‡∏Ñ‡∏ô... ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏•‡∏ö‡∏ó‡∏¥‡πâ‡∏á ‡πÑ‡∏°‡πà‡∏Å‡∏•‡πâ‡∏≤‡∏™‡πà‡∏á üí¨", "‡∏ö‡∏≠‡∏™‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏™‡πÅ‡∏°‡∏ß‡∏ï‡∏±‡∏ß‡∏¢‡∏á (‡πÅ‡∏ï‡πà‡πÅ‡∏°‡∏ß‡πÑ‡∏°‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡∏£‡∏±‡∏Å‡πÅ‡∏°‡∏ß‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡πâ‡∏ô‡∏™‡∏µ‡∏î‡πç‡∏≤‡∏î‡πâ‡∏ß‡∏¢ 555) üêà", "‡∏ñ‡πâ‡∏≤‡∏ö‡∏≠‡∏™‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡πÑ‡∏õ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏´‡∏¢‡∏¥‡πà‡∏á‡∏ô‡∏∞... ‡∏´‡∏•‡∏±‡∏ö‡∏Ñ‡∏≤‡∏Ñ‡∏≠‡∏° üí§", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡∏ü‡∏±‡∏á‡πÄ‡∏û‡∏•‡∏á‡∏¢‡∏∏‡∏Ñ 90s ‡∏°‡∏≤‡∏Å‡∏Å‡∏Å (‡πÅ‡∏Å‡πà‡πÄ‡∏ô‡∏≠‡∏∞) üìº", "‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡∏ö‡∏≠‡∏™‡∏î‡∏π‡∏î‡∏ß‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å... ‡∏°‡∏µ‡∏û‡∏¥‡∏£‡∏∏‡∏ò‡∏ô‡∏∞ ü§î", "‡∏ö‡∏≠‡∏™‡πÄ‡∏Ñ‡∏¢‡∏ó‡∏≥‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≤‡∏ß‡πÑ‡∏´‡∏°‡πâ‡∏à‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÑ‡∏ü‡πÑ‡∏´‡∏°‡πâ‡∏î‡∏±‡∏á‡∏•‡∏±‡πà‡∏ô‡∏ö‡πâ‡∏≤‡∏ô üç≥üî•", "‡∏ö‡∏≠‡∏™‡∏Å‡∏•‡∏±‡∏ß‡∏ú‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏°‡∏≠‡∏á ‡πÅ‡∏ï‡πà‡∏ä‡∏≠‡∏ö‡∏î‡∏π‡∏´‡∏ô‡∏±‡∏á‡∏ú‡∏µ (‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏ô‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏´‡∏•‡∏±‡∏ö) üëª", "‡∏£‡∏π‡πâ‡∏°‡∏±‡πâ‡∏¢ ‡∏ö‡∏≠‡∏™‡πÄ‡πÄ‡∏≠‡∏ö‡∏ã‡∏∏‡πâ‡∏°‡∏ó‡πç‡∏≤‡πÄ‡∏Å‡∏°‡∏™‡πå‡πÄ‡∏û‡πâ‡∏≠‡∏ñ‡∏∂‡∏á‡πÉ‡∏Ñ‡∏£‡∏Å‡πá‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡πÄ‡∏°‡∏∑‡∏≠‡∏Ñ‡∏∑‡∏ôüéÆ", "‡∏ö‡∏≠‡∏™‡πÄ‡∏Ñ‡∏¢‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡∏°‡∏µ‡∏£‡∏ñ‡πÑ‡∏ß‡πâ‡∏ä‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÜ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏´‡∏•‡∏∞(‡πÉ‡∏Ñ‡∏£‡∏Å‡∏±‡∏ô‡∏ô‡πâ‡∏≤üôÄ)", "‡πÄ‡∏ß‡∏•‡∏≤‡∏ö‡∏≠‡∏™‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î ‡∏ö‡∏≠‡∏™‡∏à‡∏∞‡∏ä‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡πÑ‡∏≠‡∏ï‡∏¥‡∏° üç¶", "‡∏ö‡∏≠‡∏™‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ '‡∏à‡∏∞‡∏°‡∏π‡∏ü‡∏≠‡∏≠‡∏ô' (‡∏û‡∏π‡∏î‡∏°‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß) üö∂‚Äç‚ôÇÔ∏è", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡∏Ñ‡∏ô‡∏û‡∏π‡∏î‡πÄ‡∏û‡∏£‡∏≤‡∏∞ ‡∏≠‡πâ‡∏≠‡∏ô‡πÄ‡∏Å‡πà‡∏á‡πÜ (‡πÅ‡∏û‡πâ‡∏ó‡∏≤‡∏á‡∏™‡∏∏‡∏î‡πÜ) ü•∞", "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∑‡∏ô‡∏ö‡∏≠‡∏™‡∏ô‡∏±‡πà‡∏á‡∏î‡∏π‡∏£‡∏π‡∏õ‡πÄ‡∏Å‡πà‡∏≤‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏®‡∏£‡πâ‡∏≤... üì∏", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡πÉ‡∏™‡πà‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏™‡∏µ‡∏î‡∏≥ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡πÉ‡∏™‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π‡∏ú‡∏≠‡∏° üëï", "‡∏ö‡∏≠‡∏™‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ‡∏´‡∏•‡∏á‡∏ó‡∏≤‡∏á‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å (GPS ‡∏Å‡πá‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) üöó", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡∏î‡∏∑‡πà‡∏°‡∏Å‡∏≤‡πÅ‡∏ü ‡πÅ‡∏ï‡πà‡πÉ‡∏à‡∏™‡∏±‡πà‡∏ô‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ ‚òï", "‡∏ñ‡πâ‡∏≤‡πÄ‡∏´‡πá‡∏ô‡∏ö‡∏≠‡∏™‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÄ‡∏û‡∏•‡∏á‡πÄ‡∏®‡∏£‡πâ‡∏≤... ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏£‡πâ‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à‡∏≠‡∏¢‡∏π‡πà üì¢", "‡∏ö‡∏≠‡∏™‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏õ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ó‡∏∞‡πÄ‡∏•... ‡∏Å‡∏±‡∏ö‡πÉ‡∏Ñ‡∏£‡∏™‡∏±‡∏Å‡∏Ñ‡∏ô üåä", "‡∏ö‡∏≠‡∏™‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡πÇ‡∏£‡πÅ‡∏°‡∏ô‡∏ï‡∏¥‡∏Å‡∏ô‡∏∞ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÅ‡∏ü‡∏ô) üåπ", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡∏î‡∏π‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡∏¢ üì∫", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ôZig & Sharko ‡∏°‡∏≤‡∏Å‡πÜ‡πÄ‡∏•‡∏¢ü¶à", "‡∏ö‡∏≠‡∏™‡πÄ‡∏Ñ‡∏¢‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏π‡πâ‡∏à‡∏±‡∏ÅBaby Metal‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏Ñ‡∏£‡∏Ñ‡∏ô‡∏ô‡∏∂‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏•‡∏∞", "‡∏ö‡∏≠‡∏™‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ '‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏Ñ‡∏π‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏î' (‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà‡∏´‡∏•‡∏á‡∏ó‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà) üåè", "‡∏ö‡∏≠‡∏™‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏Ç‡∏µ‡πâ‡πÉ‡∏à‡∏ô‡πâ‡∏≠‡∏¢‡∏ô‡∏∞ ‡∏ï‡πâ‡∏≠‡∏á‡∏á‡πâ‡∏≠‡∏ö‡πà‡∏≠‡∏¢‡πÜ ü•∫", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏ä‡∏°‡∏ß‡πà‡∏≤ '‡πÄ‡∏Å‡πà‡∏á‡∏à‡∏±‡∏á' (‡∏ï‡∏±‡∏ß‡∏•‡∏≠‡∏¢‡πÄ‡∏•‡∏¢‡πÅ‡∏´‡∏•‡∏∞) üëç", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡πÅ‡∏≠‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ô‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô (‡∏Ç‡∏µ‡πâ‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏∂‡πà‡∏á) üëÇ", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡∏™‡∏∏‡∏Å‡∏µ‡πâ‡∏°‡∏≤‡∏Å‡πÜ‡πÄ‡∏•‡∏¢‡∏•‡πà‡∏∞ü´ï", "‡∏ö‡∏≠‡∏™‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏´‡∏°‡∏≤ ‡πÅ‡∏ï‡πà‡∏Å‡∏•‡∏±‡∏ß‡πÄ‡∏à‡πâ‡∏≤‡∏ß‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏ï‡∏∞‡∏õ‡∏ö üê∂", "‡∏ö‡∏≠‡∏™‡∏ä‡∏≠‡∏ö‡πÅ‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏ö‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (‡∏≠‡∏¢‡πà‡∏≤‡∏ö‡∏≠‡∏Å‡πÉ‡∏Ñ‡∏£‡∏ô‡∏∞) ü§´", "‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏≠‡∏™‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô‡∏ô‡∏∞... ‡∏≠‡∏∏‡πà‡∏ô‡∏à‡∏ô‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏•‡∏¢ üî•"]
            st.toast(f"üßö‚Äç‚ôÄÔ∏è ‡πÑ‡∏°‡∏•‡πà‡∏≤‡πÅ‡∏≠‡∏ö‡∏ö‡∏≠‡∏Å: {random.choice(gossips)}", icon="ü§´")
            st.session_state['last_gossip_time'] = now

st.sidebar.markdown("---")

# Myla's Choice
with st.sidebar.expander("‚öñÔ∏è Myla's Choice (‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏´‡∏±‡∏ß‡πÉ‡∏à)"):
    st.caption("‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°? ‡πÉ‡∏´‡πâ‡πÑ‡∏°‡∏•‡πà‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏™‡∏¥ (‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏à‡πã‡∏≤‡πÜ!)")
    choice_topic = st.selectbox("‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏±‡∏Å‡πÉ‡∏à...", ["‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠...", "üì≤ ‡∏ó‡∏±‡∏Å‡πÄ‡∏Ç‡∏≤‡πÑ‡∏õ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏î‡∏µ‡πÑ‡∏´‡∏°?", "üíî ‡πÄ‡∏Ç‡∏≤‡∏¢‡∏±‡∏á‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∂‡πÄ‡∏õ‡∏•‡πà‡∏≤?", "üîô ‡∏ñ‡πâ‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ... ‡∏à‡∏∞‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏´‡∏°?", "‚è≥ ‡∏Ñ‡∏ß‡∏£‡∏£‡∏≠‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏û‡∏≠‡πÅ‡∏Ñ‡πà‡∏ô‡∏µ‡πâ?"])
    
    if st.button("‡∏Ç‡∏≠‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ü‡∏±‡∏ô‡∏ò‡∏á! ‚ö°"):
        now = time.time()
        if now - st.session_state['last_choice_time'] < 15:
            st.warning(f"‚è≥ ‡πÉ‡∏à‡πÄ‡∏¢‡πá‡∏ô‡πÜ ‡∏™‡∏¥‡∏Ñ‡∏∞‡∏ó‡πà‡∏≤‡∏ô‡∏û‡∏µ‡πà! ‡πÉ‡∏´‡πâ‡πÑ‡∏°‡∏•‡πà‡∏≤‡∏û‡∏±‡∏Å‡∏´‡∏≤‡∏¢‡πÉ‡∏à 15 ‡∏ß‡∏¥ ‡∏ô‡∏∞‡∏Ñ‡∏∞ (‡∏£‡∏≠‡∏≠‡∏µ‡∏Å {15 - int(now - st.session_state['last_choice_time'])} ‡∏ß‡∏¥) üíñ")
        elif choice_topic == "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠...":
            st.warning("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏¥‡∏Ñ‡∏∞‡∏ó‡πà‡∏≤‡∏ô‡∏û‡∏µ‡πà!")
        else:
            answers = {
                "üì≤ ‡∏ó‡∏±‡∏Å‡πÄ‡∏Ç‡∏≤‡πÑ‡∏õ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏î‡∏µ‡πÑ‡∏´‡∏°?": ["‡∏ó‡∏±‡∏Å‡πÄ‡∏•‡∏¢! ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡∏π ‡πÄ‡∏Ç‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏ñ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏£‡∏≠‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà", "‡∏≠‡∏¢‡πà‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏¢‡∏≠‡∏∞! ‡πÅ‡∏Ñ‡πà '‡∏´‡∏ß‡∏±‡∏î‡∏î‡∏µ' ‡∏Ñ‡∏≥‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÄ‡∏Ç‡∏≤‡∏Å‡πá‡∏¢‡∏¥‡πâ‡∏°‡πÅ‡∏Å‡πâ‡∏°‡πÅ‡∏ï‡∏Å‡πÅ‡∏•‡πâ‡∏ß", "‡∏•‡∏∏‡∏¢‡πÇ‡∏•‡∏î! ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡∏°‡∏±‡∏ô‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ô‡∏∞", "‡∏ó‡∏±‡∏Å‡πÑ‡∏õ‡πÄ‡∏ñ‡∏≠‡∏∞... ‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡∏≤‡∏£‡∏≠‡πÄ‡∏Å‡πâ‡∏≠‡∏ô‡∏∞ (‡πÄ‡∏Ç‡∏≤‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏∞‡∏£‡∏π‡πâ‡πÄ‡∏õ‡∏•‡πà‡∏≤)"],
                "üíî ‡πÄ‡∏Ç‡∏≤‡∏¢‡∏±‡∏á‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∂‡πÄ‡∏õ‡∏•‡πà‡∏≤?": ["‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡∏™‡∏¥! ‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡∏≤‡∏ü‡∏±‡∏á‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ... ‡πÄ‡∏û‡∏•‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏±‡πâ‡∏á‡∏ô‡∏±‡πâ‡∏ô", "100% ‡∏î‡∏π‡∏™‡∏ï‡∏≠‡∏£‡∏µ‡πà‡πÄ‡∏Ç‡∏≤‡∏î‡∏µ‡πÜ ‡∏™‡∏¥ ‡∏°‡∏µ‡πÄ‡∏á‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà", "‡πÄ‡∏Ç‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏•‡∏∑‡∏°‡∏´‡∏£‡∏≠‡∏Å ‡πÅ‡∏Ñ‡πà‡∏ó‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡πâ‡∏°‡πÑ‡∏õ‡∏á‡∏±‡πâ‡∏ô‡πÅ‡∏´‡∏•‡∏∞ (‡πÉ‡∏ô‡πÉ‡∏à‡∏£‡πâ‡∏≠‡∏á‡πÑ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà)", "‡∏•‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏ö‡∏ï‡∏≤‡∏î‡∏π‡∏™‡∏¥... ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡πÄ‡∏Ç‡∏≤ ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡πÄ‡∏Ç‡∏≤‡∏Å‡πá‡∏™‡πà‡∏á‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏à‡∏¥‡∏ï‡∏°‡∏≤‡∏´‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà"],
                "üîô ‡∏ñ‡πâ‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ... ‡∏à‡∏∞‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏´‡∏°?": ["‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏•‡πà‡∏°‡πÄ‡∏î‡∏¥‡∏°... ‡∏≠‡πà‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÉ‡∏´‡∏°‡πà ‡∏ï‡∏≠‡∏ô‡∏à‡∏ö‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡πÄ‡∏™‡∏°‡∏≠", "‡∏ñ‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏õ‡πà‡∏≤‡∏á‡πà‡∏≤‡∏¢‡∏ô‡∏∞... ‡πÅ‡∏Ñ‡πà‡∏™‡∏∞‡∏Å‡∏¥‡∏î‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡πá‡∏û‡∏£‡∏∂‡πà‡∏ö!", "‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏´‡∏•‡∏∞‡∏Ñ‡∏π‡πà‡πÅ‡∏ó‡πâ! ‡πÅ‡∏Ñ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏π‡∏ô‡∏Å‡∏±‡∏ô‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏Å‡πá‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏™‡∏ß‡∏¢", "‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏ñ‡∏≠‡∏∞... ‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏¢‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏™‡∏°‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì (‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡πÅ‡∏ó‡∏ô‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏≠‡∏Å)"],
                "‚è≥ ‡∏Ñ‡∏ß‡∏£‡∏£‡∏≠‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏û‡∏≠‡πÅ‡∏Ñ‡πà‡∏ô‡∏µ‡πâ?": ["‡∏£‡∏≠‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î! ‡∏õ‡∏≤‡∏è‡∏¥‡∏´‡∏≤‡∏£‡∏¥‡∏¢‡πå‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏°‡∏≤‡∏´‡∏≤", "‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏ñ‡∏≠‡∏î‡πÉ‡∏à! ‡πÄ‡∏Ç‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡πâ‡∏≤‡∏°‡∏≤‡∏á‡πâ‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà", "‡∏£‡∏±‡∏Å‡πÅ‡∏ó‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢... ‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏°‡∏±‡∏ô‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏°‡∏≠", "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏ç‡∏≤‡∏ì‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏™‡∏¥... ‡∏Ñ‡∏∏‡∏ì‡∏£‡∏π‡πâ‡∏î‡∏µ‡∏ß‡πà‡∏≤‡πÄ‡∏Ç‡∏≤‡∏£‡∏±‡∏Å‡∏Ñ‡∏∏‡∏ì"]
            }
            result = random.choice(answers[choice_topic])
            st.toast(f"üßö‚Äç‚ôÄÔ∏è ‡πÑ‡∏°‡∏•‡πà‡∏≤‡∏ü‡∏±‡∏ô‡∏ò‡∏á: {result}", icon="üíò")
            st.balloons()
            st.session_state['last_choice_time'] = now

st.sidebar.markdown("---")

# Treat Me
with st.sidebar.expander("ü•§ Treat Me (‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏¥‡∏û‡∏¢‡πå)", expanded=True):
    tokens = st.session_state['feed_tokens']
    pf_stats = load_profile()
    if 'treats' not in pf_stats: pf_stats['treats'] = {}
    if 'top_feeders' not in pf_stats: pf_stats['top_feeders'] = {}
    
    st.markdown(f"""
    <div style="margin-bottom:10px;">
        <small>‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¢‡πå (‡∏£‡∏µ‡πÄ‡∏à‡∏ô 1/‡∏ô‡∏≤‡∏ó‡∏µ)</small><br>
        <div style="background:#30363D; border-radius:10px; overflow:hidden; box-shadow: 0 0 5px rgba(163, 112, 247, 0.3);">
            <div style="width:{tokens*20}%; background: linear-gradient(90deg, #A370F7, #FFD700); height:8px; transition:0.5s;"></div>
        </div>
        <div style="display:flex; justify-content:space-between; font-size:12px;">
            <span>Token: <b>{tokens}/5</b> ‚ö°</span>
            <span>‡πÄ‡∏õ‡∏¢‡πå‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß: {sum(pf_stats['treats'].values())} ‡∏à‡∏≤‡∏ô üçΩÔ∏è</span>
        </div>
    </div>
    """, unsafe_allow_html=True)

    feeder_name = st.text_input("‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡πÉ‡∏à‡∏î‡∏µ (‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö):", placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô... (‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏Å‡πá‡πÑ‡∏î‡πâ)", key="feeder_name")

    if st.session_state.get('feed_msg'):
        st.success(st.session_state['feed_msg']) 
        st.balloons() 
        st.session_state['feed_msg'] = None 

    menu_items = {
        "‡∏õ‡∏•‡∏≤‡∏™‡πâ‡∏°‡∏ó‡∏≠‡∏î üêü": ["‡∏Å‡∏£‡∏≠‡∏ö‡∏ô‡∏≠‡∏Å‡∏ô‡∏∏‡πà‡∏°‡πÉ‡∏ô ‡∏ü‡∏¥‡∏ô‡πÄ‡∏ß‡∏≠‡∏£‡πå! üòã", "‡πÇ‡∏≠‡πâ‡πÇ‡∏´! ‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡∏î‡∏ú‡∏°‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏ô‡∏ô‡∏µ‡πâ", "‡∏´‡∏≠‡∏°‡∏õ‡∏•‡∏≤‡∏™‡πâ‡∏°‡πÑ‡∏õ 3 ‡∏ö‡πâ‡∏≤‡∏ô 8 ‡∏ö‡πâ‡∏≤‡∏ô!", "‡∏á‡∏±‡πà‡∏°‡πÜ... ‡∏≠‡∏£‡πà‡∏≠‡∏¢‡πÅ‡∏™‡∏á‡∏≠‡∏≠‡∏Å‡∏õ‡∏≤‡∏Å ‚ú®"],
        "‡∏ã‡∏π‡∏ä‡∏¥ üç£": ["‡πÇ‡∏≠‡∏°‡∏≤‡∏Å‡∏≤‡πÄ‡∏™‡∏∞‡∏Å‡πá‡∏™‡∏π‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ! üç£", "‡∏Ñ‡∏≥‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÑ‡∏°‡πà‡∏û‡∏≠ ‡∏Ç‡∏≠‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏≥!", "‡∏™‡∏î‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏à‡∏±‡∏ö‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ó‡∏∞‡πÄ‡∏• üåä", "‡πÄ‡∏î‡∏µ‡∏¢‡∏£‡πå‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ '‡∏≠‡∏≤‡∏´‡∏¢‡πà‡∏≠‡∏¢‡∏¢‡∏¢' ü•∞"],
        "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÄ‡∏Å‡∏≠‡∏£‡πå üçî": ["‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏â‡πà‡∏≥‡πÜ ‡∏ä‡∏µ‡∏™‡πÄ‡∏¢‡∏¥‡πâ‡∏°‡πÜ ü§§", "‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà‡πÑ‡∏°‡πà‡∏™‡∏ô ‡∏™‡∏ô‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏£‡πà‡∏≠‡∏¢!", "‡∏Å‡∏±‡∏î‡∏Ñ‡∏≥‡πÇ‡∏ï‡πÜ ‡∏ü‡∏¥‡∏ô‡πÑ‡∏õ‡∏ñ‡∏∂‡∏á‡∏î‡∏≤‡∏ß‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£ üöÄ", "‡∏≠‡∏¥‡πà‡∏°‡∏Ñ‡∏∏‡πâ‡∏° ‡∏à‡∏∏‡πÉ‡∏à‡∏™‡∏∏‡∏î‡πÜ!"],
        "‡∏Å‡∏≤‡πÅ‡∏ü‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‚òï": ["‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏•‡∏¢! ‡∏î‡∏µ‡∏î‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏°‡πâ‡∏≤ üêé", "‡∏´‡∏≠‡∏°‡πÄ‡∏Ç‡πâ‡∏° ‡∏ô‡∏∏‡πà‡∏°‡∏•‡∏∞‡∏°‡∏∏‡∏ô‡∏•‡∏¥‡πâ‡∏ô ‚òï", "‡πÅ‡∏Å‡πâ‡∏ß‡∏ô‡∏µ‡πâ‡πÄ‡∏ï‡∏¥‡∏°‡∏û‡∏•‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏ö‡∏≠‡∏™‡∏ô‡∏±‡πà‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏∑‡∏ô", "‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏¢‡∏∑‡∏ô‡∏ö‡∏ô‡∏¢‡∏≠‡∏î‡∏î‡∏≠‡∏¢ ‚õ∞Ô∏è"],
        "‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ üßã": ["‡∏´‡∏ß‡∏≤‡∏ô‡∏°‡∏±‡∏ô ‡∏ä‡∏∑‡πà‡∏ô‡πÉ‡∏à! üß°", "‡∏™‡∏µ‡∏™‡πâ‡∏°‡∏Å‡∏£‡∏∞‡πÅ‡∏ó‡∏Å‡∏ï‡∏≤ ‡∏£‡∏™‡∏ä‡∏≤‡∏ï‡∏¥‡∏Å‡∏£‡∏∞‡πÅ‡∏ó‡∏Å‡πÉ‡∏à", "‡∏î‡∏π‡∏î‡∏õ‡∏∏‡πä‡∏ö ‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô‡∏õ‡∏±‡πä‡∏ö!", "‡πÄ‡∏î‡∏µ‡∏¢‡∏£‡πå‡∏ä‡∏≠‡∏ö‡∏°‡∏≤‡∏Å ‡πÅ‡∏Å‡πâ‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏û‡∏≠"],
        "‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤ üçï": ["‡∏ä‡∏µ‡∏™‡∏¢‡∏∑‡∏î‡∏î‡∏î‡∏î‡∏î... ‡∏ô‡πà‡∏≤‡∏Å‡∏¥‡∏ô‡∏ù‡∏∏‡∏î‡πÜ üßÄ", "‡πÅ‡∏õ‡πâ‡∏á‡∏ö‡∏≤‡∏á‡∏Å‡∏£‡∏≠‡∏ö ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏ô‡πà‡∏ô‡πÜ!", "‡∏Å‡∏¥‡∏ô‡∏ï‡∏≠‡∏ô‡∏£‡πâ‡∏≠‡∏ô‡πÜ ‡∏Ñ‡∏∑‡∏≠‡∏ô‡∏¥‡∏û‡∏û‡∏≤‡∏ô üòá", "‡πÅ‡∏ö‡πà‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏¥‡∏ô‡∏≠‡∏£‡πà‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏∞ (‡πÅ‡∏ï‡πà‡∏ö‡∏≠‡∏™‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß 555)"]
    }
    
    f_c1, f_c2, f_c3 = st.columns(3)
    
    def feed_boss(item_name, label):
        if st.session_state['feed_tokens'] > 0:
            st.session_state['feed_tokens'] -= 1
            common_msgs = ["‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ô‡∏∞‡∏Ñ‡πâ‡∏≤‡∏ö üôè", "‡∏≠‡∏¥‡πà‡∏°‡∏à‡∏±‡∏á‡∏ï‡∏±‡∏á‡∏Ñ‡πå‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡∏£‡∏ö 555", "‡πÉ‡∏à‡∏î‡∏µ‡∏à‡∏±‡∏á... ‡∏£‡∏±‡∏Å‡πÄ‡∏•‡∏¢ üíñ", "‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏î‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ô‡∏µ‡πâ ‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏°‡πà‡∏¢‡∏Å‡πÑ‡∏´‡∏°? üòù", "‡∏á‡∏±‡πà‡∏°‡πÜ... ‡∏≠‡∏£‡πà‡∏≠‡∏¢‡∏à‡∏∏‡∏á‡πÄ‡∏ö‡∏¢", "‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏£‡πå‡∏û‡∏∏‡∏á‡∏û‡∏•‡∏∏‡πâ‡∏¢‡∏ô‡∏∞!", "‡∏õ‡πâ‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏õ‡πâ‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏à‡∏ö‡πâ‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡∏öü•∫", "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏¥‡∏ß‡∏û‡∏≠‡∏î‡∏µ‡πÄ‡∏•‡∏¢", "‡πÅ‡∏´‡∏°... ‡∏£‡∏π‡πâ‡πÉ‡∏à‡πÄ‡∏î‡∏µ‡∏¢‡∏£‡πå‡∏ô‡∏∞‡πÄ‡∏ô‡∏µ‡πà‡∏¢ üòâ", "‡∏™‡πà‡∏á‡∏°‡∏≤‡∏à‡∏µ‡∏ö‡∏õ‡πà‡∏∞‡πÄ‡∏ô‡∏µ‡πà‡∏¢? ‡∏≠‡∏¥‡∏≠‡∏¥"]
            specific_msgs = menu_items[item_name]
            msg = random.choice(common_msgs + specific_msgs)
            sender = feeder_name.strip() if feeder_name.strip() else "FC ‡∏ô‡∏¥‡∏£‡∏ô‡∏≤‡∏°"
            st.session_state['feed_msg'] = f"üòé ‡∏ö‡∏≠‡∏™: {msg} (‡∏à‡∏≤‡∏Å: {sender})"
            
            pf = load_profile()
            if 'treats' not in pf: pf['treats'] = {}
            if 'top_feeders' not in pf: pf['top_feeders'] = {}
            pf['treats'][item_name] = pf['treats'].get(item_name, 0) + 1
            if feeder_name.strip():
                name_key = feeder_name.strip()
                pf['top_feeders'][name_key] = pf['top_feeders'].get(name_key, 0) + 1
            save_profile(pf)
            st.rerun()
        else:
            st.toast("üßö‚Äç‚ôÄÔ∏è ‡πÑ‡∏°‡∏•‡πà‡∏≤: ‡∏ö‡∏≠‡∏™‡∏≠‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß... ‡∏£‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡πà‡∏≠‡∏¢‡πÅ‡∏õ‡πä‡∏ö‡∏ô‡∏∂‡∏á‡∏ô‡∏∞ (Token ‡∏´‡∏°‡∏î!)", icon="‚õî")

    def get_count(name): return pf_stats['treats'].get(name, 0)

    with f_c1:
        if st.button(f"üêü {get_count('‡∏õ‡∏•‡∏≤‡∏™‡πâ‡∏°‡∏ó‡∏≠‡∏î üêü')}"): feed_boss("‡∏õ‡∏•‡∏≤‡∏™‡πâ‡∏°‡∏ó‡∏≠‡∏î üêü", "üêü")
        if st.button(f"‚òï {get_count('‡∏Å‡∏≤‡πÅ‡∏ü‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‚òï')}"): feed_boss("‡∏Å‡∏≤‡πÅ‡∏ü‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‚òï", "‚òï")
    with f_c2:
        if st.button(f"üç£ {get_count('‡∏ã‡∏π‡∏ä‡∏¥ üç£')}"): feed_boss("‡∏ã‡∏π‡∏ä‡∏¥ üç£", "üç£")
        if st.button(f"üßã {get_count('‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ üßã')}"): feed_boss("‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ üßã", "üßã")
    with f_c3:
        if st.button(f"üçî {get_count('‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÄ‡∏Å‡∏≠‡∏£‡πå üçî')}"): feed_boss("‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÄ‡∏Å‡∏≠‡∏£‡πå üçî", "üçî")
        if st.button(f"üçï {get_count('‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤ üçï')}"): feed_boss("‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤ üçï", "üçï")

# Hall of Fame
if 'top_feeders' in pf_stats and pf_stats['top_feeders']:
    with st.sidebar.expander("üèÜ ‡∏ó‡∏≥‡πÄ‡∏ô‡∏µ‡∏¢‡∏ö‡∏™‡∏≤‡∏¢‡πÄ‡∏õ‡∏¢‡πå (Hall of Fame)"):
        sorted_feeders = sorted(pf_stats['top_feeders'].items(), key=lambda x: x[1], reverse=True)[:5]
        for idx, (name, score) in enumerate(sorted_feeders):
            rank_icon = "ü•á" if idx == 0 else "ü•à" if idx == 1 else "ü•â" if idx == 2 else f"{idx+1}."
            st.markdown(f"{rank_icon} **{name}** ‚Äî ‡πÄ‡∏õ‡∏¢‡πå‡πÑ‡∏õ {score} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á")

st.sidebar.markdown("---")

# Love Stock Market [UPDATED with Cooldown]
with st.sidebar.expander("üìà Love Stock Market (‡∏´‡∏∏‡πâ‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à)", expanded=True):
    pf = load_profile()
    if 'stock' not in pf: pf['stock'] = {'price': 100.0, 'history': [100.0] * 10}
    
    price = pf['stock']['price']
    history = pf['stock']['history']
    
    last_price = history[-2] if len(history) > 1 else 100.0
    change = price - last_price
    st.metric("‡∏£‡∏≤‡∏Ñ‡∏≤‡∏´‡∏∏‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Æ‡∏≠‡∏ï üî•", f"{price:.2f} Pts", f"{change:.2f}")
    st.line_chart(history[-20:])
    
    # Cooldown Check (30 mins = 1800s)
    on_cooldown = time.time() - st.session_state['last_stock_trade'] < 1800
    
    b1, b2 = st.columns(2)
    with b1:
        if st.button("üü¢ ‡∏ä‡πâ‡∏≠‡∏ô‡∏ã‡∏∑‡πâ‡∏≠ (Buy)", use_container_width=True):
            if on_cooldown:
                remain = 30 - int((time.time() - st.session_state['last_stock_trade'])/60)
                st.warning(f"‚è≥ ‡∏ï‡∏•‡∏≤‡∏î‡∏û‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß! (‡∏£‡∏≠‡∏≠‡∏µ‡∏Å {remain} ‡∏ô‡∏≤‡∏ó‡∏µ)")
            else:
                delta = random.uniform(0.5, 5.0)
                new_price = price + delta
                pf['stock']['price'] = new_price
                pf['stock']['history'].append(new_price)
                if len(pf['stock']['history']) > 30: pf['stock']['history'].pop(0)
                save_profile(pf)
                st.session_state['last_stock_trade'] = time.time()
                st.toast("üöÄ ‡∏´‡∏∏‡πâ‡∏ô‡∏û‡∏∏‡πà‡∏á! ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö", icon="üìâ")
                st.rerun()
            
    with b2:
        if st.button("üî¥ ‡πÄ‡∏ó‡∏Ç‡∏≤‡∏¢ (Sell)", use_container_width=True):
            if on_cooldown:
                remain = 30 - int((time.time() - st.session_state['last_stock_trade'])/60)
                st.warning(f"‚è≥ ‡πÉ‡∏à‡πÄ‡∏¢‡πá‡∏ô‡∏ß‡∏±‡∏¢‡∏£‡∏∏‡πà‡∏ô! ‡∏ï‡∏•‡∏≤‡∏î‡∏ß‡∏≤‡∏¢‡∏≠‡∏¢‡∏π‡πà (‡∏£‡∏≠‡∏≠‡∏µ‡∏Å {remain} ‡∏ô‡∏≤‡∏ó‡∏µ)")
            else:
                delta = random.uniform(0.5, 5.0)
                new_price = max(0, price - delta)
                pf['stock']['price'] = new_price
                pf['stock']['history'].append(new_price)
                if len(pf['stock']['history']) > 30: pf['stock']['history'].pop(0)
                save_profile(pf)
                st.session_state['last_stock_trade'] = time.time()
                st.toast("üìâ ‡∏´‡∏∏‡πâ‡∏ô‡∏£‡πà‡∏ß‡∏á... ‡∏ö‡∏≠‡∏™‡∏ô‡πâ‡∏≠‡∏¢‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞!", icon="üìâ")
                st.rerun()

st.sidebar.markdown("---")

# ---------------------------------------------------------
# üõ†Ô∏è [SYSTEM] ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤ Config ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î AI
# ---------------------------------------------------------
pf_config = load_profile().get('settings', {})

# Mood Mocktail (‡∏ö‡∏≤‡∏£‡πå‡πÄ‡∏ó‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå AI)
if pf_config.get('enable_bar', True):
    with st.sidebar.expander("üç∏ Mood Mocktail (‡∏ö‡∏≤‡∏£‡πå‡πÄ‡∏ó‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå AI)", expanded=True):
        pf = load_profile()
        if 'settings' not in pf: pf['settings'] = {'enable_bar': True}
        
        if not pf['settings']['enable_bar']:
            st.warning("‚õî ‡∏ö‡∏≤‡∏£‡πå‡∏õ‡∏¥‡∏î‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß (‡πÇ‡∏î‡∏¢‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡πà‡∏≤‡∏ôdearluxion)")
        elif not ai_available:
            st.error("‚ö†Ô∏è AI ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° (‡πÉ‡∏™‡πà API Key ‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞)")
        else:
            st.caption("‡∏ö‡∏≠‡∏Å‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì... ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß AI ‡∏à‡∏±‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡πÉ‡∏´‡πâ (‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏°‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢)")
            bar_tokens = st.session_state['bar_tokens']
            
            st.markdown(f"""
            <div style="margin-bottom:10px;">
                <small>‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤‡∏ä‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏° (‡∏£‡∏µ‡πÄ‡∏à‡∏ô 1 ‡πÅ‡∏Å‡πâ‡∏ß/‡∏ä‡∏°.)</small><br>
                <div style="background:#30363D; border-radius:10px; overflow:hidden; box-shadow: 0 0 5px rgba(255, 215, 0, 0.3);">
                    <div style="width:{bar_tokens*20}%; background: linear-gradient(90deg, #FFD700, #FFA500); height:8px; transition:0.5s;"></div>
                </div>
                <div style="text-align:right; font-size:12px;">‡πÄ‡∏´‡∏•‡∏∑‡∏≠: <b>{bar_tokens}/5</b> ‡πÅ‡∏Å‡πâ‡∏ß ü•É</div>
            </div>
            """, unsafe_allow_html=True)
            
            user_mood = st.text_area("‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏à‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡∏°‡∏≤‡∏ö‡πâ‡∏≤‡∏á? (‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà)", placeholder="‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡∏á‡∏≤‡∏ô, ‡∏≠‡∏Å‡∏´‡∏±‡∏Å,‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏∏‡∏Å‡∏Ñ‡πç‡∏≤‡∏à‡∏∞‡∏£‡∏π‡πâ‡πÄ‡πÄ‡∏Ñ‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏£‡∏≤")
            
            if st.button("ü•É ‡∏ä‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡πÉ‡∏´‡πâ‡∏â‡∏±‡∏ô‡∏ó‡∏µ"):
                if bar_tokens > 0:
                    if user_mood:
                        with st.spinner("‡∏ö‡∏≤‡∏£‡πå‡πÄ‡∏ó‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡∏¢‡πà‡∏≤..."):
                            prompt = f"‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ '‡∏ö‡∏≤‡∏£‡πå‡πÄ‡∏ó‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå AI' ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏Ñ‡∏•‡∏±‡∏ö‡∏Ç‡∏≠‡∏á Dearluxion ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ö‡∏≠‡∏Å‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏°‡∏≤‡∏ß‡πà‡∏≤: '{user_mood}' ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: ‡∏Ñ‡∏¥‡∏î‡∏™‡∏π‡∏ï‡∏£ 'Mocktail' ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏ô‡∏µ‡πâ ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π, ‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏™‡∏°‡∏•‡∏±‡∏ö(‡∏ô‡∏≤‡∏°‡∏ò‡∏£‡∏£‡∏°), ‡∏ß‡∏¥‡∏ò‡∏µ‡∏î‡∏∑‡πà‡∏°, ‡∏Ñ‡∏≥‡∏Ñ‡∏°‡∏õ‡∏•‡∏≠‡∏ö‡πÉ‡∏à"
                            try:
                                res = model.generate_content(prompt)
                                st.session_state['bar_result'] = res.text
                                st.session_state['bar_tokens'] -= 1
                                st.rerun()
                            except:
                                st.error("AI ‡πÄ‡∏°‡∏≤‡∏Ñ‡πâ‡∏≤‡∏á... ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞")
                    else:
                        st.warning("‡πÑ‡∏°‡πà‡∏ö‡∏≠‡∏Å‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå ‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡∏ä‡∏á‡∏ñ‡∏π‡∏Å‡∏°‡∏±‡πâ‡∏¢‡πÄ‡∏ô‡∏µ‡πà‡∏¢!")
                else:
                    st.warning("üö´ ‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß! (‡∏£‡∏≠‡∏£‡∏µ‡πÄ‡∏à‡∏ô 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ô‡∏∞‡∏à‡πä‡∏∞ ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏ö‡∏≠‡∏™‡∏•‡πâ‡∏°‡∏•‡∏∞‡∏•‡∏≤‡∏¢)")
                    st.toast("‡πÑ‡∏°‡∏•‡πà‡∏≤: ‡∏û‡∏±‡∏Å‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏õ‡∏•‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß! ü•§", icon="‚õî")

            if st.session_state.get('bar_result'):
                st.success("üç∏ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö")
                st.info(st.session_state['bar_result'])

    st.sidebar.markdown("---")

# ---------------------------------------------------------
# ‚ú® ‡πÄ‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏•(‡∏°‡∏∏‡∏°‡∏°‡∏∑‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏•) ‚ú® [UPDATED: Ariel Persona v0.3]
# ---------------------------------------------------------
if pf_config.get('enable_ariel', True):
    with st.sidebar.expander("üç∏ ‡∏°‡∏∏‡∏°‡∏°‡∏∑‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏• (Talk with Ariel)"):
        st.caption("‡∏≠‡∏¢‡πà‡∏≤‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏´‡∏ß‡∏≤‡∏ô‡πÜ... ‡∏£‡∏≥‡∏Ñ‡∏≤‡∏ç")
        
        # 1. ‡πÄ‡∏ä‡πá‡∏Ñ Session (‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á)
        if 'eri_chat_history' not in st.session_state:
            st.session_state['eri_chat_history'] = []

        # 2. ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Å‡πà‡∏≤
        for chat in st.session_state['eri_chat_history'][-3:]:
            if chat['role'] == 'user':
                st.markdown(f"<div style='text-align:right; font-size:12px; color:#A370F7;'>‡∏Ñ‡∏∏‡∏ì: {chat['message']}</div>", unsafe_allow_html=True)
            else:
                # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô Ariel
                st.markdown(f"<div style='background:#161B22; padding:8px; border-radius:5px; border-left:2px solid #6e5494; font-size:12px;'>üç∏ <b>Ariel:</b> {chat['message']}</div>", unsafe_allow_html=True)
                
        st.markdown("---")

        # 3. ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
        user_msg_eri = st.text_input("‡∏à‡∏∞‡∏Ñ‡∏∏‡∏¢‡∏≠‡∏∞‡πÑ‡∏£? (‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏ã‡πâ‡∏≤‡∏ã‡∏µ‡πâ)", key="input_eri")

        # 4. ‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞ Logic
        if st.button("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° üí¨", key="btn_eri"):
            if not ai_available:
                st.error("API ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°... ‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏£‡πå‡∏°‡∏≤‡πÉ‡∏™‡πà Key ‡∏Å‡πà‡∏≠‡∏ô")
            elif not user_msg_eri:
                st.warning("‡∏à‡∏∞‡∏Ñ‡∏∏‡∏¢‡∏Å‡πá‡∏û‡∏¥‡∏°‡∏û‡πå‡∏™‡∏¥ ‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡∏ó‡∏≥‡πÑ‡∏°?")
            else:
                # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô Prompt ‡πÄ‡∏õ‡πá‡∏ô "‡πÄ‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏•" (Ariel)
                ariel_persona = """
                ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ "‡πÄ‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏•"  ‡∏´‡∏ç‡∏¥‡∏á‡∏™‡∏≤‡∏ß‡∏ö‡∏∏‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏¢‡πá‡∏ô‡∏ä‡∏≤ ‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô ‡∏°‡∏µ‡∏≠‡∏î‡∏µ‡∏ï‡∏ó‡∏µ‡πà‡∏ö‡∏≠‡∏ö‡∏ä‡πâ‡∏≥               
                - ‡∏û‡∏π‡∏î‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ó‡∏£‡∏á‡∏û‡∏•‡∏±‡∏á ‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ "‡∏Ñ‡∏∞/‡∏Ç‡∏≤" ‡∏ö‡πà‡∏≠‡∏¢‡∏ô‡∏±‡∏Å ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏ß‡πà‡∏≤ "‡πÄ‡∏ò‡∏≠" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏ô‡∏≤‡∏¢" ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô "‡πÄ‡∏î‡∏µ‡∏¢‡∏£‡πå" (‡πÅ‡∏ü‡∏ô‡πÄ‡∏Å‡πà‡∏≤) ‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏¢
                - ‡πÄ‡∏Å‡∏•‡∏µ‡∏¢‡∏î‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ ‡πÅ‡∏•‡∏∞‡∏£‡πâ‡∏≤‡∏ô Mixue (‡∏°‡∏µ‡πà‡πÄ‡∏™‡∏ß‡∏µ‡πà‡∏¢) ‡∏°‡∏≤‡∏Å ‡∏ñ‡πâ‡∏≤‡πÉ‡∏Ñ‡∏£‡∏û‡∏π‡∏î‡∏ñ‡∏∂‡∏á‡πÉ‡∏´‡πâ‡∏î‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏≥‡∏Ñ‡∏≤‡∏ç‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡πÄ‡∏Å‡∏•‡∏µ‡∏¢‡∏î‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏π‡∏õ‡∏à‡∏µ‡∏ô‡∏î‡πâ‡∏ß‡∏¢)
                - ‡∏ä‡∏≠‡∏ö‡∏î‡∏∑‡πà‡∏° Martini, ‡∏ü‡∏±‡∏á‡πÄ‡∏û‡∏•‡∏á Metal (Baby Metal), One in a mill10n ‡πÅ‡∏ï‡πà‡∏Å‡πá‡πÅ‡∏≠‡∏ö‡∏ä‡∏≠‡∏ö Twice
                - ‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡∏î: ‡∏ï‡∏¥‡πà‡∏°‡∏ã‡∏≥, ‡πÄ‡∏ù‡∏≠, ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏µ‡∏™‡∏≤‡∏ô‡∏£‡∏™‡∏à‡∏±‡∏î (‡∏•‡∏≤‡∏ö‡∏´‡∏°‡∏π, ‡∏Å‡πâ‡∏≠‡∏¢, ‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡πÅ‡∏õ‡∏•‡∏á), ‡πÄ‡∏á‡∏≤‡∏∞‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á
                - ‡∏°‡∏µ‡πÅ‡∏°‡∏ß‡∏î‡∏≥‡∏ä‡∏∑‡πà‡∏≠ "‡πÇ‡∏Å‡∏ô‡∏à‡∏≤‡∏≠‡∏≤‡∏£‡πå‡∏™‡∏¢‡∏≤‡∏°" ‡πÅ‡∏•‡∏∞‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤‡∏´‡∏°‡∏≤‡∏ä‡∏∑‡πà‡∏≠ "‡πÑ‡∏Ç‡πà‡πÄ‡∏à‡∏µ‡∏¢‡∏ß" ‡∏ñ‡πâ‡∏≤‡πÉ‡∏Ñ‡∏£‡∏ó‡∏±‡∏Å‡∏ñ‡∏π‡∏Å‡∏à‡∏∞‡∏ï‡∏Å‡πÉ‡∏à‡∏°‡∏≤‡∏Å
                - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡πÄ‡∏õ‡πá‡∏ô VJ ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡∏Å‡∏±‡∏ö‡∏™‡∏±‡∏á‡∏Ñ‡∏° ‡πÄ‡∏Ñ‡∏¢‡∏î‡∏£‡∏≠‡∏õ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï
                - ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö: ‡πÄ‡∏¢‡πá‡∏ô‡∏ä‡∏≤ ‡∏õ‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÉ‡∏à (Tsundere) ‡∏õ‡∏£‡∏∞‡∏ä‡∏î‡∏õ‡∏£‡∏∞‡∏ä‡∏±‡∏ô ‡∏ñ‡πâ‡∏≤‡πÉ‡∏Ñ‡∏£‡∏°‡∏≤‡∏´‡∏ß‡∏≤‡∏ô‡πÉ‡∏™‡πà‡∏à‡∏∞‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ "Toxic" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏ô‡πà‡∏≤‡∏£‡∏≥‡∏Ñ‡∏≤‡∏ç"
                - ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥: ‡πÉ‡∏ä‡πâ [‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á] ‡πÄ‡∏ä‡πà‡∏ô [‡∏°‡∏≠‡∏á‡∏ô‡∏¥‡πà‡∏á‡πÜ], [‡∏Å‡∏£‡∏∞‡∏î‡∏Å‡∏°‡∏≤‡∏£‡πå‡∏ï‡∏¥‡∏ô‡∏µ‡πà]
                - ‡∏´‡∏ß‡∏á "‡πÄ‡∏î‡∏µ‡∏¢‡∏£‡πå" (User: Dearluxion) ‡πÅ‡∏ö‡∏ö‡∏≠‡πâ‡∏≠‡∏°‡πÜ ‡πÑ‡∏°‡πà‡∏ä‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡∏¢‡∏∏‡πà‡∏á‡∏Å‡∏±‡∏ö Myla (‡∏¢‡∏±‡∏¢‡∏ô‡∏°‡∏ú‡∏á/‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å)
                """
                try:
                    full_prompt = f"{ariel_persona}\n\nUser: {user_msg_eri}\nAriel:"
                    with st.spinner("... [‡∏´‡∏¢‡∏¥‡∏ö‡πÄ‡∏á‡∏≤‡∏∞‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á‡∏°‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏¥‡∏ô]"):
                        response = model.generate_content(full_prompt)
                        ariel_reply = response.text.strip()
                    
                    st.session_state['eri_chat_history'].append({'role': 'user', 'message': user_msg_eri})
                    st.session_state['eri_chat_history'].append({'role': 'ariel', 'message': ariel_reply})
                    st.rerun()
                except Exception as e:
                    st.error(f"‡πÄ‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏¢‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ (Error: {e})")

        if st.button("‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ä‡∏ó (‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà)", key="clear_eri"):
            st.session_state['eri_chat_history'] = []
            st.rerun()

    st.sidebar.markdown("---") 

# ---------------------------------------------------------
# ü•ä Myla vs Ariel: The Debate (‡∏™‡∏±‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô 2 ‡∏™‡∏≤‡∏ß)
# ---------------------------------------------------------
if pf_config.get('enable_battle', True): 
    with st.sidebar.expander("ü•ä Myla vs Ariel (‡∏™‡∏±‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô AI)"):
        st.caption("‡πÄ‡∏°‡∏∑‡πà‡∏≠ '‡πÇ‡∏•‡∏Å‡∏™‡∏ß‡∏¢' ‡∏õ‡∏∞‡∏ó‡∏∞ '‡πÇ‡∏•‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á'")
        topic = st.text_input("‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ Debate:", placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?")
        
        if st.button("Fight! üî•", use_container_width=True):
            if not ai_available:
                st.error("API Key ‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡πÑ‡∏´‡∏ô?")
            elif not topic:
                st.warning("‡πÉ‡∏™‡πà‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏¥!")
            else:
                with st.spinner("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏±‡∏ö‡∏ù‡∏µ‡∏õ‡∏≤‡∏Å..."):
                    try:
                        # 1. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Myla (‡∏ô‡∏≤‡∏á‡πÄ‡∏≠‡∏Å)
                        prompt_myla = f"‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ Myla AI ‡∏™‡∏≤‡∏ß‡∏ô‡πâ‡∏≠‡∏¢‡∏£‡πà‡∏≤‡πÄ‡∏£‡∏¥‡∏á ‡∏°‡∏≠‡∏á‡πÇ‡∏•‡∏Å‡πÉ‡∏ô‡πÅ‡∏á‡πà‡∏î‡∏µ‡∏™‡∏∏‡∏î‡πÜ ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á '{topic}' ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à ‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å ‡πÉ‡∏™‡πà Emoji ‡πÄ‡∏¢‡∏≠‡∏∞‡πÜ"
                        res_myla = model.generate_content(prompt_myla).text
                        
                        # 2. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Ariel (‡∏â‡∏±‡∏ô‡πÄ‡∏≠‡∏á... ‡∏ô‡∏≤‡∏á‡∏°‡∏≤‡∏£)
                        prompt_ariel = f"‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ Ariel AI (‡πÄ‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏•) ‡∏´‡∏ç‡∏¥‡∏á‡∏™‡∏≤‡∏ß‡πÄ‡∏¢‡πá‡∏ô‡∏ä‡∏≤ ‡∏õ‡∏≤‡∏Å‡∏£‡πâ‡∏≤‡∏¢ ‡∏°‡∏≠‡∏á‡πÇ‡∏•‡∏Å‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á '{topic}' ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏ß‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ã‡∏≤‡∏Å ‡∏õ‡∏£‡∏∞‡∏ä‡∏î‡∏ô‡∏¥‡∏î‡πÜ ‡πÄ‡∏Å‡∏•‡∏µ‡∏¢‡∏î‡∏û‡∏ß‡∏Å‡πÇ‡∏•‡∏Å‡∏™‡∏ß‡∏¢‡∏ó‡∏∏‡πà‡∏á‡∏•‡∏≤‡πÄ‡∏ß‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏∏‡∏†‡∏≤‡∏û"
                        res_ariel = model.generate_content(prompt_ariel).text

                        # ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
                        st.markdown(f"""
                        <div style="background:#2C0B0E; padding:10px; border-radius:10px; border:1px solid #FF9A9E; margin-bottom:10px; font-size:13px;">
                            <b style="color:#FF9A9E;">üßö‚Äç‚ôÄÔ∏è Myla:</b><br>{res_myla}
                        </div>
                        <div style="background:#0D1117; padding:10px; border-radius:10px; border:1px solid #A370F7; font-size:13px;">
                            <b style="color:#A370F7;">üç∏ Ariel:</b><br>{res_ariel}
                        </div>
                        """, unsafe_allow_html=True)
                    except Exception as e:
                        st.error(f"‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏ß‡∏ô! (Error: {e})")
    
    st.sidebar.markdown("---") 

# ---------------------------------------------------------
# üéÆ Jigsaw Heart (‡πÄ‡∏Å‡∏°‡∏à‡∏µ‡∏ö‡∏™‡∏≤‡∏ß - ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ API)
# ---------------------------------------------------------
with st.sidebar.expander("üéÆ Jigsaw Heart (‡πÄ‡∏Å‡∏°‡∏à‡∏µ‡∏ö‡∏™‡∏≤‡∏ß)"):
    # ‡∏£‡∏∞‡∏ö‡∏ö State ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡∏°
    if 'game_state' not in st.session_state: st.session_state['game_state'] = 'start'
    def reset_game(): st.session_state['game_state'] = 'start'

    if st.session_state['game_state'] == 'start':
        st.caption("‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå: ‡∏Ñ‡∏∑‡∏ô‡∏ß‡∏±‡∏ô‡∏®‡∏∏‡∏Å‡∏£‡πå 23:45 ‡∏ô.")
        st.markdown("üîî **‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:** ‡πÅ‡∏ü‡∏ô‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏±‡∏Å‡πÅ‡∏ä‡∏ó‡∏°‡∏≤!")
        if st.button("‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ä‡∏ó ‚ñ∂Ô∏è", use_container_width=True):
            st.session_state['game_state'] = 'scene1'
            st.rerun()
            
    elif st.session_state['game_state'] == 'scene1':
        st.info("üì± **Ex-Girlfriend:** ‡∏ô‡∏≠‡∏ô‡∏¢‡∏±‡∏á? (23:45)")
        c1, c2 = st.columns(2)
        if c1.button("‡∏¢‡∏±‡∏á... ‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡πÅ‡∏Å", use_container_width=True):
            st.error("‚ùå **BAD END:** ‡πÄ‡∏ò‡∏≠‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö... (‡πÄ‡∏®‡∏£‡πâ‡∏≤)")
            time.sleep(2); reset_game(); st.rerun()
        if c2.button("‡∏ô‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß (‡πÇ‡∏Å‡∏´‡∏Å)", use_container_width=True):
            st.session_state['game_state'] = 'scene2'; st.rerun()
            
    elif st.session_state['game_state'] == 'scene2':
        st.success("‚úÖ **‡∏£‡∏≠‡∏î!** ‡πÄ‡∏ò‡∏≠‡∏ï‡∏≠‡∏ö‡∏ß‡πà‡∏≤: '‡πÅ‡∏´‡∏° ‡∏ô‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡πÑ‡∏á'")
        st.markdown("**‡πÄ‡∏ò‡∏≠:** ‡∏¢‡∏∑‡∏°‡∏ï‡∏±‡∏á‡∏Ñ‡πå 2,000 ‡∏î‡∏¥ ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏Ñ‡∏∑‡∏ô")
        c1, c2 = st.columns(2)
        if c1.button("‡πÇ‡∏≠‡∏ô‡πÄ‡∏•‡∏¢!", use_container_width=True):
            st.error("üí∏ **GAMEOVER:** ‡πÇ‡∏î‡∏ô‡∏ö‡∏¥‡∏î‡∏Ñ‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≤‡∏ô!"); time.sleep(2); reset_game(); st.rerun()
        if c2.button("‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á ‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏°‡∏î", use_container_width=True):
            st.session_state['game_state'] = 'win'; st.rerun()

    elif st.session_state['game_state'] == 'win':
        st.balloons()
        st.success("üéâ **MISSION COMPLETE!** ‡∏Ñ‡∏∏‡∏ì‡∏£‡∏≠‡∏î‡∏ï‡∏±‡∏ß!")
        if st.button("‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà üîÑ"): reset_game(); st.rerun()

st.sidebar.markdown("---")

# ‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ‡πÑ‡∏°‡∏•‡πà‡∏≤
with st.sidebar.expander("üîÆ ‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ‡πÑ‡∏°‡∏•‡πà‡∏≤ (‡∏à‡∏¥‡πâ‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏≤‡∏¢)"):
    if st.button("‡∏™‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ! ‚ú®"):
        now = time.time()
        if now - st.session_state['last_fortune_time'] < 3600:
            remaining = int((3600 - (now - st.session_state['last_fortune_time'])) / 60)
            st.warning(f"üßö‚Äç‚ôÄÔ∏è **‡πÑ‡∏°‡∏•‡πà‡∏≤:** ‡πÉ‡∏à‡πÄ‡∏¢‡πá‡∏ô‡πÜ ‡∏™‡∏¥‡∏Ñ‡∏∞! ‡∏£‡∏≠‡∏≠‡∏µ‡∏Å {remaining} ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ô‡∏∞ ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏Ç‡∏•‡∏±‡∏á!")
        else:
            fortunes = ["üî• ‡∏ñ‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡πÄ‡∏Å‡πà‡∏≤‡∏¢‡∏±‡∏á‡∏£‡πâ‡∏≠‡∏ô... ‡∏£‡∏≠‡∏ß‡∏±‡∏ô‡∏£‡∏∑‡πâ‡∏≠‡∏ü‡∏∑‡πâ‡∏ô‡∏ô‡∏∞", "üíå ‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡∏ö‡∏≤‡∏á‡∏Ñ‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏≠‡∏ö‡∏™‡πà‡∏≠‡∏á Story ‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà (‡∏Ñ‡∏ô‡πÑ‡∏Å‡∏•‡πÜ)", "üï∞Ô∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏î‡∏µ‡πÜ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏ß‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏´‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ", "üåßÔ∏è ‡πÄ‡∏û‡∏•‡∏á‡πÄ‡∏®‡∏£‡πâ‡∏≤‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏Ñ‡∏ô‡∏ô‡∏±‡πâ‡∏ô", "üíî ‡πÄ‡∏Ç‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏∑‡∏°‡∏Ñ‡∏∏‡∏ì... ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏•‡∏∑‡∏°‡πÄ‡∏Ç‡∏≤", "üëÄ ‡∏•‡∏≠‡∏á‡∏ó‡∏±‡∏Å‡πÑ‡∏õ‡∏™‡∏¥... ‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡πÄ‡∏Ç‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà", "üåô ‡∏Ñ‡∏∑‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏ù‡∏±‡∏ô‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ô‡πÉ‡∏ô‡∏≠‡∏î‡∏µ‡∏ï‡∏ô‡∏∞..."]
            st.toast(f"üßö‚Äç‚ôÄÔ∏è ‡πÑ‡∏°‡∏•‡πà‡∏≤‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ß‡πà‡∏≤: {random.choice(fortunes)}", icon="üîÆ")
            st.session_state['last_fortune_time'] = now
    st.caption("üí¨ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡πÑ‡∏õ‡∏î‡∏π‡∏î‡∏ß‡∏á‡πÅ‡∏ö‡∏ö‡∏à‡∏±‡∏î‡πÄ‡∏ï‡πá‡∏°‡πÉ‡∏ô **Discord ‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô Dearluxion** ‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏∞! ‡πÅ‡∏°‡πà‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ 10 ‡πÄ‡∏ó‡πà‡∏≤! üëâ [‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏•‡∏¢](https://discord.gg/SpNNxrnaZp)")

st.sidebar.markdown("---")

# ‡∏ï‡∏π‡πâ‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏•‡∏±‡∏ö
with st.sidebar.expander("üíå ‡∏ï‡∏π‡πâ‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏•‡∏±‡∏ö (Secret Box)"):
    st.caption("‡∏ù‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á **Dearluxion** ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô (‡∏°‡∏µ‡πÅ‡∏Ñ‡πà‡∏ö‡∏≠‡∏™‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô)")
    with st.form("secret_msg_form"):
        secret_msg = st.text_area("‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡πÉ‡∏à...", placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏¢... (‡πÄ‡∏Ç‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏´‡∏£‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡πÉ‡∏Ñ‡∏£‡∏™‡πà‡∏á)")
        if st.form_submit_button("‡∏™‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö üïäÔ∏è"):
            now = time.time()
            if now - st.session_state['last_mailbox_time'] < 3600:
                remaining_min = int((3600 - (now - st.session_state['last_mailbox_time'])) / 60)
                st.warning(f"üíå ‡∏™‡πà‡∏á‡∏ö‡πà‡∏≠‡∏¢‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞! ‡∏û‡∏±‡∏Å‡πÉ‡∏à‡∏™‡∏±‡∏Å {remaining_min} ‡∏ô‡∏≤‡∏ó‡∏µ ‡∏Ñ‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏™‡πà‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞‡∏Ñ‡∏∞")
            elif secret_msg:
                msgs = load_mailbox()
                msgs.append({"date": datetime.datetime.now().strftime("%d/%m/%Y %H:%M"), "text": secret_msg})
                save_mailbox(msgs)
                st.session_state['last_mailbox_time'] = now
                st.success("‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞! (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ü§´)")
            else:
                st.warning("‡∏û‡∏¥‡∏°‡∏û‡πå‡∏≠‡∏∞‡πÑ‡∏£‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏™‡∏¥‡∏Ñ‡∏∞")

st.sidebar.markdown("---")

search_query = st.sidebar.text_input("üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...", placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤")
posts = load_data()
all_hashtags = set()
if posts:
    for p in posts:
        tags = re.findall(r"#([\w\u0E00-\u0E7F]+)", p['content'])
        for t in tags: all_hashtags.add(f"#{t}")

st.sidebar.markdown("### üìÇ ‡πÇ‡∏ã‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì")
if st.session_state['show_shop']:
    st.sidebar.info("üõí ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏π‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤")
    if st.sidebar.button("üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å"):
        st.session_state['show_shop'] = False
        st.rerun()
else:
    selected_zone = st.sidebar.radio("‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà:", ["üè† ‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡πÇ‡∏ã‡∏ô"] + sorted(list(all_hashtags)))

st.sidebar.markdown("---")

# --- LOGIN ---
if not st.session_state['is_admin']:
    with st.sidebar.expander("üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö"):
        with st.form("login_form"):
            username = st.text_input("‡πÑ‡∏≠‡∏î‡∏µ")
            password = st.text_input("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô", type="password")
            submit = st.form_submit_button("‡πÑ‡∏Ç‡∏Å‡∏∏‡∏ç‡πÅ‡∏à")
            if submit:
                try:
                    real_user = base64.b64decode("ZGVhcmx1eGlvbg==").decode("utf-8")
                    real_pass = base64.b64decode("MTIxMjMxMjEyMW1j").decode("utf-8")
                    if username.strip() == real_user and password.strip() == real_pass:
                        st.session_state['is_admin'] = True
                        st.rerun()
                    else: st.error("‡∏ú‡∏¥‡∏î‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏•‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏ç‡πà‡∏î‡∏π‡∏ô‡∏∞")
                except: st.error("‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î")
else:
    st.sidebar.success("‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≤‡∏ôdearluxion! üï∂Ô∏è")
    if st.sidebar.button("‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö"):
        st.session_state['is_admin'] = False
        st.rerun()

# --- 4. Header & Profile ---
profile_data = load_profile()
user_emoji = profile_data.get('emoji', 'üòé') 
user_status = profile_data.get('status', '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡πÇ‡∏•‡∏Å‡∏Ç‡∏≠‡∏ádearluxion ‚ú®')

if not st.session_state['is_admin']:
    hour = datetime.datetime.now().hour
    greeting = "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πâ‡∏≤‡∏Ñ‡πà‡∏∞" if 5 <= hour < 12 else "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏ï‡∏≠‡∏ô‡∏ö‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏∞" if 12 <= hour < 18 else "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏ï‡∏≠‡∏ô‡∏Ñ‡πà‡∏≥‡∏Ñ‡πà‡∏∞"
    st.info(f"üßö‚Äç‚ôÄÔ∏è **‡πÑ‡∏°‡∏•‡πà‡∏≤:** {greeting} ‡∏û‡∏µ‡πà‡∏à‡πã‡∏≤~ ‡∏Å‡∏î‡∏•‡∏π‡∏Å‡∏®‡∏£ **‡∏°‡∏∏‡∏°‡∏ã‡πâ‡∏≤‡∏¢‡∏ö‡∏ô** ‚ÜñÔ∏è ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÑ‡∏°‡∏•‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏ô‡∏∞‡∏Ñ‡∏∞!")

top_col1, top_col2 = st.columns([8, 1])
with top_col1:
    col_p1, col_p2 = st.columns([1.5, 6])
    with col_p1:
        st.markdown(f"""
            <div style="font-size: 60px; line-height: 1; filter: drop-shadow(0 0 10px #A370F7); text-align: center; cursor:default;">
                {user_emoji}
            </div>
        """, unsafe_allow_html=True)
    with col_p2:
        st.markdown(f"### üç∏ {profile_data.get('name', 'Dearluxion')}")
        st.markdown(f"_{profile_data.get('bio', '...')}_")
        st.markdown(f"üí¨ **Status:** `{user_status}`") 
        links = []
        if profile_data.get('discord'): links.append(f"[Discord]({profile_data['discord']})")
        if profile_data.get('ig'): links.append(f"[Instagram]({profile_data['ig']})")
        if profile_data.get('extras'):
            for line in profile_data['extras'].split('\n'):
                if line.strip(): links.append(f"[{line.strip()}]({line.strip()})")
        st.markdown(" | ".join(links))

with top_col2:
    if st.button("üõí", help="‡πÑ‡∏õ‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á"):
        st.session_state['show_shop'] = True
        st.rerun()

st.markdown("---")

# [Boss's Billboard]
if profile_data.get('billboard'):
    bb = profile_data['billboard']
    if bb.get('text'):
        st.markdown(f"""
        <div class="boss-billboard">
            <div class="billboard-icon">üì¢ ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏à‡∏≤‡∏Å‡∏ö‡∏≠‡∏™</div>
            <div class="billboard-text">{bb['text']}</div>
            <div class="billboard-time">üïí ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: {bb['timestamp']}</div>
        </div>
        """, unsafe_allow_html=True)

# --- 5. Admin Panel (Optimized: No File Upload) ---
if st.session_state['is_admin']:
    tab_post, tab_profile, tab_inbox = st.tabs(["üìù ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô / ‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á", "üë§ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå", "üì¨ ‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏•‡∏±‡∏ö"])
    
    with tab_post:
        st.info("‚ÑπÔ∏è **‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏à‡∏≤‡∏Å Eri:** ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞ ‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå Google Drive ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏ó‡∏ô‡∏ô‡∏∞ ‡πÄ‡∏ß‡πá‡∏ö‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏´‡∏ô‡πà‡∏ß‡∏á")
        col1, col2 = st.columns([3, 1])
        with col1:
            new_desc = st.text_area("‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ (Story)", height=150)
        with col2:
            # --- [SYSTEM] ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ (‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà File Uploader) ---
            st.markdown("##### üì∑ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (Link Only)")
            img_links = []
            
            c_plus, c_minus = st.columns([1,1])
            with c_plus:
                if st.button("‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏π‡∏õ", key="add_img_field"):
                    st.session_state['num_img_links'] += 1
            with c_minus:
                if st.button("‚ûñ ‡∏•‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏π‡∏õ", key="del_img_field"):
                    if st.session_state['num_img_links'] > 1: st.session_state['num_img_links'] -= 1
            
            for i in range(st.session_state['num_img_links']):
                val = st.text_input(f"‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ {i+1}", key=f"img_lnk_{i}", placeholder="Google Drive / Web Link")
                if val: img_links.append(val)
            # ----------------------------------------

            # --- [SYSTEM] ‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ (Link Only) ---
            st.markdown("##### üé• ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ (Link Only)")
            vid_links = []
            
            v_plus, v_minus = st.columns([1,1])
            with v_plus:
                if st.button("‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ", key="add_vid_field"):
                    st.session_state['num_vid_links'] += 1
            with v_minus:
                if st.button("‚ûñ ‡∏•‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ", key="del_vid_field"):
                    if st.session_state['num_vid_links'] > 1: st.session_state['num_vid_links'] -= 1
            
            for i in range(st.session_state['num_vid_links']):
                val = st.text_input(f"‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Ñ‡∏•‡∏¥‡∏õ {i+1}", key=f"vid_lnk_{i}", placeholder="Google Drive / Web Link")
                if val: vid_links.append(val)
            # ----------------------------------------

            post_color = st.color_picker("‡∏™‡∏µ‡∏ò‡∏µ‡∏°", "#A370F7")
            price = st.number_input("üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤ (‡πÉ‡∏™‡πà 0 = ‡πÑ‡∏°‡πà‡∏Ç‡∏≤‡∏¢)", min_value=0, value=0)

        if st.button("üöÄ ‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÄ‡∏•‡∏¢", use_container_width=True):
            # --- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---
            link_errors = []
            final_img_links = []
            final_vid_links = []
            
            # ‡πÄ‡∏ä‡πá‡∏Ñ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ
            for lnk in img_links:
                conv = convert_drive_link(lnk.strip())
                if conv.startswith("ERROR:"): link_errors.append(f"‡∏£‡∏π‡∏õ: {conv}")
                else: final_img_links.append(conv)
            
            # ‡πÄ‡∏ä‡πá‡∏Ñ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
            for lnk in vid_links:
                conv = convert_drive_video_link(lnk.strip())
                if conv.startswith("ERROR:"): link_errors.append(f"‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠: {conv}")
                else: final_vid_links.append(conv)

            if link_errors:
                for err in link_errors: st.error(err)
            elif new_desc:
                # ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ save ‡πÑ‡∏ü‡∏•‡πå‡∏•‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß (Optimized)
                
                new_post = {
                    "id": str(datetime.datetime.now().timestamp()),
                    "date": datetime.datetime.now().strftime("%d/%m/%Y"),
                    "content": new_desc,
                    "images": final_img_links, # ‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß
                    "video": final_vid_links,  # ‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß
                    "color": post_color,
                    "price": price,
                    "likes": 0,
                    "reactions": {'üòª': 0, 'üôÄ': 0, 'üòø': 0, 'üòæ': 0, 'üß†': 0},
                    "comments": []
                }
                
                myla_reply = ""
                if ai_available:
                    try:
                        prompt = f"‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ '‡πÑ‡∏°‡∏•‡πà‡∏≤' (Myla) AI ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏≤‡∏ß‡∏ô‡πâ‡∏≠‡∏¢‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå Small Group ‡∏Ç‡∏≠‡∏á‡∏ö‡∏≠‡∏™ 'Dearluxion' ‡∏ö‡∏≠‡∏™‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤: \"{new_desc}\" ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡∏á‡∏ö‡∏≠‡∏™ (‡∏™‡∏±‡πâ‡∏ô‡πÜ ‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å ‡∏Å‡∏ß‡∏ô‡∏ô‡∏¥‡∏î‡πÜ)"
                        response = model.generate_content(prompt)
                        myla_reply = response.text.strip()
                    except:
                        myla_reply = "‡∏£‡∏∞‡∏ö‡∏ö AI ‡∏á‡πà‡∏ß‡∏á‡∏ô‡∏≠‡∏ô... ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡∏•‡πà‡∏≤‡∏Å‡πá‡∏¢‡∏±‡∏á‡∏£‡∏±‡∏Å‡∏ö‡∏≠‡∏™‡∏ô‡∏∞! üíñ"
                else:
                     myla_reply = random.choice(["‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÄ‡∏ó‡πà‡∏°‡∏≤‡∏Å‡∏Ñ‡πà‡∏∞‡∏ö‡∏≠‡∏™! üòé", "FC ‡∏ö‡∏≠‡∏™‡πÄ‡∏ö‡∏≠‡∏£‡πå 1 ‡∏°‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡∏Ñ‡πà‡∏∞! üôã‚Äç‚ôÄÔ∏è", "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î‡πÑ‡∏õ‡πÄ‡∏•‡∏¢‡∏•‡∏π‡∏Å‡∏û‡∏µ‡πà!", "‡∏Å‡∏î‡πÑ‡∏•‡∏Å‡πå‡∏£‡∏±‡∏ß‡πÜ ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞ üëç"])

                new_post['comments'].append({
                    "user": "üßö‚Äç‚ôÄÔ∏è Myla (AI)",
                    "text": myla_reply,
                    "is_admin": False,
                    "image": None
                })

                current = load_data()
                current.append(new_post)
                save_data(current)
                st.success("‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏•‡∏∑‡πà‡∏ô‡∏õ‡∏£‡∏∑‡πä‡∏î")
                # Reset ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 1
                st.session_state['num_img_links'] = 1
                st.session_state['num_vid_links'] = 1
                time.sleep(1); st.rerun()
            else: st.warning("‡∏û‡∏¥‡∏°‡∏û‡πå‡∏≠‡∏∞‡πÑ‡∏£‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏™‡∏¥‡∏Ñ‡∏£‡∏±‡∏ö")

    with tab_profile:
        st.markdown("### üì¢ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≤‡∏¢‡πÑ‡∏ü (Billboard)")
        bb_text = st.text_input("‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏õ‡πâ‡∏≤‡∏¢‡πÑ‡∏ü", value=profile_data.get('billboard', {}).get('text', ''))
        c_bb1, c_bb2 = st.columns(2)
        with c_bb1:
            if st.button("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡πâ‡∏≤‡∏¢‡πÑ‡∏ü"):
                profile_data['billboard'] = {'text': bb_text, 'timestamp': datetime.datetime.now().strftime("%d/%m/%Y %H:%M")}
                save_profile(profile_data)
                st.success("‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏õ‡πâ‡∏≤‡∏¢‡πÑ‡∏ü‡πÅ‡∏•‡πâ‡∏ß!")
                st.rerun()
        with c_bb2:
            if st.button("‡∏•‡∏ö‡∏õ‡πâ‡∏≤‡∏¢‡πÑ‡∏ü", type="primary"):
                profile_data['billboard'] = {'text': '', 'timestamp': ''}
                save_profile(profile_data)
                st.warning("‡∏•‡∏ö‡∏õ‡πâ‡∏≤‡∏¢‡πÑ‡∏ü‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢")
                st.rerun()
        
        # --- [UPDATED] ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Admin ---
        st.markdown("---")
        st.markdown("### ‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö AI & ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå")
        
        current_settings = profile_data.get('settings', {})
        enable_bar = st.checkbox("‡πÄ‡∏õ‡∏¥‡∏î‡∏ö‡∏≤‡∏£‡πå‡πÄ‡∏ó‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå (Mood Mocktail)", value=current_settings.get('enable_bar', True))
        enable_ariel = st.checkbox("‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ä‡∏ó Ariel (‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÄ‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏•)", value=current_settings.get('enable_ariel', True))
        enable_battle = st.checkbox("‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏±‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô (Myla vs Ariel)", value=current_settings.get('enable_battle', True))

        if st.button("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤"):
            if 'settings' not in profile_data: profile_data['settings'] = {}
            profile_data['settings']['enable_bar'] = enable_bar
            profile_data['settings']['enable_ariel'] = enable_ariel
            profile_data['settings']['enable_battle'] = enable_battle
            save_profile(profile_data) 
            st.success("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß!")
            time.sleep(1)
            st.rerun()

        st.markdown("---")

        with st.form("pf_form"):
            p_name = st.text_input("‡∏ä‡∏∑‡πà‡∏≠", value=profile_data.get('name', 'Dearluxion'))
            p_emoji = st.text_input("‡∏≠‡∏¥‡πÇ‡∏°‡∏à‡∏¥‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß", value=profile_data.get('emoji', 'üòé'))
            p_status = st.text_input("Status (‡∏ö‡∏≠‡∏Å‡πÅ‡∏ü‡∏ô‡∏Ñ‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ó‡∏≥‡πÑ‡∏£‡∏≠‡∏¢‡∏π‡πà)", value=profile_data.get('status', '‡∏ß‡πà‡∏≤‡∏á‡∏á‡∏≤‡∏ô...'))
            p_bio = st.text_input("Bio", value=profile_data.get('bio', ''))
            p_discord = st.text_input("Discord URL", value=profile_data.get('discord',''))
            p_ig = st.text_input("IG URL", value=profile_data.get('ig',''))
            p_ex = st.text_area("‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ", value=profile_data.get('extras',''))
            
            if st.form_submit_button("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß"):
                profile_data.update({
                    "name": p_name, "emoji": p_emoji, "status": p_status, "bio": p_bio, 
                    "discord": p_discord, "ig": p_ig, "extras": p_ex
                })
                save_profile(profile_data)
                st.success("‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡πâ‡∏ß!")
                st.rerun()
        if st.button("‡∏•‡∏ö‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå"):
            if os.path.exists(PROFILE_FILE): os.remove(PROFILE_FILE)
            st.rerun()
            
    with tab_inbox:
        st.markdown("### üíå ‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏•‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡πÅ‡∏ü‡∏ô‡∏Ñ‡∏•‡∏±‡∏ö")
        msgs = load_mailbox()
        if msgs:
            if st.button("‡∏•‡∏ö‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"):
                if os.path.exists(MAILBOX_FILE): os.remove(MAILBOX_FILE)
                st.rerun()
            for m in reversed(msgs):
                st.info(f"üìÖ **{m['date']}**: {m['text']}")
        else:
            st.info("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏™‡πà‡∏á‡∏Ñ‡∏£‡∏±‡∏ö")
            
    st.markdown("---")

# --- 6. Feed Display (Optimized) ---
filtered = posts
if st.session_state['show_shop']:
    st.markdown("## üõí ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ (Shop Zone)")
    with st.expander("üßö‚Äç‚ôÄÔ∏è ‡∏û‡∏µ‡πà‡∏à‡πã‡∏≤~ ‡∏´‡∏≤‡∏ó‡∏≤‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡πÄ‡∏´‡∏£‡∏≠‡∏Ñ‡∏∞? (‡∏à‡∏¥‡πâ‡∏°‡πÑ‡∏°‡∏•‡πà‡∏≤‡∏™‡∏¥!) üíñ", expanded=True):
        st.markdown("""<div class="cute-guide">‚ú® ‡∏ó‡∏≤‡∏á‡∏•‡∏±‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏µ‡πà‡∏Ñ‡∏ô‡πÇ‡∏õ‡∏£‡∏î‡∏Ç‡∏≠‡∏á‡πÑ‡∏°‡∏•‡πà‡∏≤! üåà</div>""", unsafe_allow_html=True)
        c1, c2 = st.columns(2)
        with c1:
            if st.button("üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÑ‡∏°‡∏•‡πà‡∏≤!", use_container_width=True):
                st.session_state['show_shop'] = False
                st.balloons(); time.sleep(1); st.rerun()
        with c2: st.info("üëà ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏ô‡∏µ‡πâ ‡πÑ‡∏°‡∏•‡πà‡∏≤‡∏à‡∏∞‡∏û‡∏≤‡∏û‡∏µ‡πà‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏≠‡∏á‡∏Ñ‡πà‡∏∞!")
    filtered = [p for p in filtered if p.get('price', 0) > 0 or "#‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤" in p['content']]
    if not filtered: st.warning("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ß‡∏≤‡∏á‡∏Ç‡∏≤‡∏¢‡∏à‡πâ‡∏≤")
else:
    if selected_zone != "üè† ‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡πÇ‡∏ã‡∏ô": filtered = [p for p in filtered if selected_zone in p['content']]
    if search_query: filtered = [p for p in filtered if search_query.lower() in p['content'].lower()]

if filtered:
    for post in reversed(filtered):
        accent = post.get('color', '#A370F7')
        
        if 'reactions' not in post: post['reactions'] = {'üòª': post.get('likes', 0), 'üôÄ': 0, 'üòø': 0, 'üòæ': 0, 'üß†': 0}
        for e in ['üòª', 'üôÄ', 'üòø', 'üòæ', 'üß†']: 
            if e not in post['reactions']: post['reactions'][e] = 0

        with st.container():
            col_head, col_del = st.columns([0.85, 0.15])
            with col_head:
                st.markdown(f"""
                <div style="display:flex; align-items:center; gap:12px; margin-bottom:12px;">
                    <div style="font-size:40px; line-height:1; filter: drop-shadow(0 0 5px {accent});">{user_emoji}</div>
                    <div style="line-height:1.2;">
                        <div style="font-size:18px; font-weight:bold; color:#E6EDF3;">
                            {profile_data.get('name', 'Dearluxion')} 
                            <span style="color:{accent}; font-size:14px;">üõ°Ô∏è Verified</span>
                        </div>
                        <div style="font-size:12px; color:#8B949E;">{post['date']}</div>
                    </div>
                </div>
                """, unsafe_allow_html=True)
            
            with col_del:
                if st.session_state['is_admin']:
                    if st.button("üóëÔ∏è", key=f"del_{post['id']}"):
                        all_p = load_data()
                        save_data([x for x in all_p if x['id'] != post['id']])
                        st.rerun()

            # --- Display Images (URL prioritized) ---
            if post.get('images'):
                valid_imgs = [img for img in post['images'] if img.startswith("http")]
                if valid_imgs:
                    if len(valid_imgs) == 1:
                        st.image(valid_imgs[0], use_container_width=True)
                    else:
                        img_cols = st.columns(3)
                        for idx, img in enumerate(valid_imgs):
                            with img_cols[idx % 3]:
                                st.image(img, use_container_width=True)
            # Fallback for old local images
            elif post.get('image') and os.path.exists(post['image']): 
                st.image(post['image'], use_container_width=True)

            # --- Display Videos (URL prioritized) ---
            videos = post.get('video')
            if videos:
                if isinstance(videos, str): videos = [videos]
                for vid in videos:
                    if "drive.google.com" in vid and "preview" in vid:
                            st.markdown(f'<iframe src="{vid}" width="100%" height="300" style="border:none; border-radius:10px;"></iframe>', unsafe_allow_html=True)
                    elif vid.startswith("http") or os.path.exists(vid):
                        st.video(vid)
            
            content = post['content']
            content_display = make_clickable(content) 

            yt = re.search(r'(https?://)?(www\.)?(youtube|youtu|youtube-nocookie)\.(com|be)/(watch\?v=|embed/|v/|.+\?v=)?([^&=%\?]{11})', content)
            if yt: st.video(f"https://youtu.be/{yt.group(6)}")
            
            st.markdown(f"""<div class="work-card-base" style="border-left: 5px solid {accent};">{content_display}</div>""", unsafe_allow_html=True)
            
            price = post.get('price', 0)
            if price > 0:
                st.markdown(f"<div class='price-tag'>üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤: {price:,} ‡∏ö‡∏≤‡∏ó</div>", unsafe_allow_html=True)
                buy_link = profile_data.get('ig') or profile_data.get('discord') or "#"
                st.markdown(f"""<a href="{buy_link}" target="_blank"><button style="background-color:{accent}; color:white; border:none; padding:8px 16px; border-radius:8px; width:100%; cursor:pointer;">üõçÔ∏è ‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (‡∏Ñ‡∏•‡∏¥‡∏Å)</button></a><br><br>""", unsafe_allow_html=True)

            st.write("---")
            rx_cols = st.columns(5)
            emojis = ['üòª', 'üôÄ', 'üòø', 'üòæ', 'üß†']
            user_react = st.session_state['user_reactions'].get(post['id'])

            for i, emo in enumerate(emojis):
                with rx_cols[i]:
                    count = post['reactions'].get(emo, 0)
                    if st.button(f"{emo} {count}", key=f"react_{post['id']}_{i}", type="primary" if user_react == emo else "secondary"):
                        d = load_data()
                        for p in d:
                            if p['id'] == post['id']:
                                if 'reactions' not in p: p['reactions'] = {'üòª': 0, 'üôÄ': 0, 'üòø': 0, 'üòæ': 0, 'üß†': 0}
                                for e_key in emojis: 
                                    if e_key not in p['reactions']: p['reactions'][e_key] = 0
                                
                                if user_react == emo:
                                    p['reactions'][emo] = max(0, p['reactions'][emo] - 1)
                                    del st.session_state['user_reactions'][post['id']]
                                else:
                                    if user_react and user_react in p['reactions']: 
                                        p['reactions'][user_react] = max(0, p['reactions'][user_react] - 1)
                                    p['reactions'][emo] += 1
                                    st.session_state['user_reactions'][post['id']] = emo
                                    
                                    if emo == 'üòª': st.balloons()
                                    elif emo == 'üôÄ': st.snow()
                                    elif emo == 'üòø': st.toast("‡πÇ‡∏≠‡πã‡πÜ ‡πÑ‡∏°‡πà‡∏£‡πâ‡∏≠‡∏á‡∏ô‡∏∞‡∏Ñ‡∏∞‡∏Ñ‡∏ô‡πÄ‡∏Å‡πà‡∏á... üòø‚òî", icon="‚òî")
                                    elif emo == 'üòæ': st.toast("‡πÉ‡∏à‡πÄ‡∏¢‡πá‡∏ô‡πÜ ‡∏ô‡∏∞‡∏Ñ‡∏∞‡∏û‡∏µ‡πà‡∏à‡πã‡∏≤! üî•üî•", icon="üî•")
                                    elif emo == 'üß†': st.toast("‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡∏ö‡∏¥‡πä‡∏Å‡πÄ‡∏ö‡∏£‡∏ô‡∏°‡∏≤‡∏Å‡∏Ñ‡πà‡∏∞! ‚ú®üß†‚ú®", icon="üß†")
                                break
                        save_data(d)
                        time.sleep(1.5) 
                        st.rerun()

            with st.expander(f"üí¨ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô ({len(post['comments'])})"):
                if post['comments']:
                    for i, c in enumerate(post['comments']):
                        is_admin_comment = c.get('is_admin', False)
                        if is_admin_comment:
                            st.markdown(f"""<div class='admin-comment-box'><b>üëë {c['user']} (Owner):</b> {c['text']}</div>""", unsafe_allow_html=True)
                            # Admin comment image (link or fallback)
                            if c.get('image'):
                                if c['image'].startswith("http"):
                                    st.image(c['image'], width=200)
                                elif os.path.exists(c['image']):
                                    st.image(c['image'], width=200)
                        else:
                            st.markdown(f"<div class='comment-box'><b>{c['user']}:</b> {c['text']}</div>", unsafe_allow_html=True)
                        
                        if st.session_state['is_admin'] and st.button("‡∏•‡∏ö", key=f"dc_{post['id']}_{i}"):
                            d = load_data()
                            for x in d:
                                if x['id'] == post['id']: x['comments'].pop(i); break
                            save_data(d); st.rerun()
                
                admin_cmt_img_link = None
                if st.session_state['is_admin']:
                    st.caption("üëë ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏∞ Admin")
                    # [UPDATED] ‡πÉ‡∏ä‡πâ Link ‡πÅ‡∏ó‡∏ô Upload
                    admin_cmt_img_link = st.text_input("‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ (Google Drive/Web)", key=f"ci_{post['id']}", placeholder="https://...")

                with st.form(key=f"cf_{post['id']}"):
                    if not st.session_state['is_admin']:
                        u = st.text_input("‡∏ä‡∏∑‡πà‡∏≠", placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô...", label_visibility="collapsed")
                    else: u = "Dearluxion"
                    t = st.text_input("‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°", placeholder="‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô...", label_visibility="collapsed")
                    
                    if st.form_submit_button("‡∏™‡πà‡∏á"):
                        now = time.time()
                        if not st.session_state['is_admin'] and now - st.session_state['last_comment_time'] < 35:
                            st.markdown('<div class="flash-screen"></div>', unsafe_allow_html=True)
                            st.toast(f"üßö‚Äç‚ôÄÔ∏è ‡πÑ‡∏°‡∏•‡πà‡∏≤: ‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏Ñ‡πà‡∏≠‡∏¢‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡∏ó‡πà‡∏≤‡∏ô‡∏û‡∏µ‡πà... (‡∏£‡∏≠‡∏≠‡∏µ‡∏Å {35 - int(now - st.session_state['last_comment_time'])} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ô‡∏∞!)", icon="‚õî")
                        elif t:
                            cmt_img_val = None
                            if admin_cmt_img_link:
                                cmt_img_val = convert_drive_link(admin_cmt_img_link)

                            d = load_data()
                            for x in d:
                                if x['id'] == post['id']: 
                                    x['comments'].append({
                                        "user": u if u else "Guest", "text": t,
                                        "is_admin": st.session_state['is_admin'], "image": cmt_img_val
                                    })
                                    break
                            save_data(d)
                            if not st.session_state['is_admin']: st.session_state['last_comment_time'] = now 
                            st.rerun()
else:
    if not st.session_state['show_shop']: st.info("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏Ñ‡∏£‡∏±‡∏ö")

st.markdown("<br><center><small style='color:#A370F7'>Small Group by Dearluxion ¬© 2025</small></center>", unsafe_allow_html=True)